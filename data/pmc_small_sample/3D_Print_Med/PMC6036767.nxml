<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="brief-report"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">3D Print Med</journal-id><journal-id journal-id-type="iso-abbrev">3D Print Med</journal-id><journal-title-group><journal-title>3D Printing in Medicine</journal-title></journal-title-group><issn pub-type="epub">2365-6271</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">30050977</article-id><article-id pub-id-type="pmc">6036767</article-id><article-id pub-id-type="publisher-id">8</article-id><article-id pub-id-type="doi">10.1186/s41205-016-0008-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Technical Note</subject></subj-group></article-categories><title-group><article-title>Medical 3D printing for vascular interventions and surgical oncology: a primer for the 2016 radiological society of North America (RSNA) hands-on course in 3D printing</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7010-3812</contrib-id><name><surname>Chepelev</surname><given-names>Leonid</given-names></name><address><email>leonid.chepelev@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hodgdon</surname><given-names>Taryn</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Gupta</surname><given-names>Ashish</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Aili</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Torres</surname><given-names>Carlos</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Krishna</surname><given-names>Satheesh</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Akyuz</surname><given-names>Ekin</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mitsouras</surname><given-names>Dimitrios</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Sheikh</surname><given-names>Adnan</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.28046.38</institution-id><institution-id institution-id-type="ISNI">0000000121822255</institution-id><institution>The Ottawa Hospital Research Institute and the Department of Radiology, </institution><institution>University of Ottawa, </institution></institution-wrap>501 Smyth Road, Box 232, Ottawa, Ontario K1H 8L6 Canada </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.28046.38</institution-id><institution-id institution-id-type="ISNI">0000000121822255</institution-id><institution>Faculty of Medicine, </institution><institution>University of Ottawa, </institution></institution-wrap>Ottawa, Canada </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.62560.37</institution-id><institution-id institution-id-type="ISNI">0000000403788294</institution-id><institution>Department of Radiology, Applied Imaging Science Lab, </institution><institution>Brigham and Women&#x02019;s Hospital, </institution></institution-wrap>Boston, MA USA </aff></contrib-group><pub-date pub-type="epub"><day>1</day><month>12</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>1</day><month>12</month><year>2016</year></pub-date><pub-date pub-type="collection"><month>12</month><year>2016</year></pub-date><volume>2</volume><elocation-id>5</elocation-id><history><date date-type="received"><day>12</day><month>10</month><year>2016</year></date><date date-type="accepted"><day>21</day><month>10</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2016</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p>Medical 3D printing holds the potential of transforming personalized medicine by enabling the fabrication of patient-specific implants, reimagining prostheses, developing surgical guides to expedite and transform surgical interventions, and enabling a growing multitude of specialized applications. In order to realize this tremendous potential in frontline medicine, an understanding of the basic principles of 3D printing by the medical professionals is required. This primer underlines the basic approaches and tools in 3D printing, starting from patient anatomy acquired through cross-sectional imaging, in this case Computed Tomography (CT). We describe the basic principles using the relatively simple task of separation of the relevant anatomy to guide aneurysm repair. This is followed by exploration of more advanced techniques in the creation of patient-specific surgical guides and prostheses for a patient with extensive pleomorphic sarcoma using Computer Aided Design (CAD) software.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s41205-016-0008-6) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>3D Printing</kwd><kwd>Aneurysm repair</kwd><kwd>Cancer</kwd><kwd>Segmentation</kwd><kwd>Computer-aided design</kwd><kwd>Orthopedic Surgery</kwd><kwd>Implant</kwd><kwd>Surgical Guide</kwd><kwd>Radiological Society of North America</kwd><kwd>Precision Medicine</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2016</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p>In the short interval since the publication of our initial practical medical 3D printing guide for the 2015 annual RSNA meeting [<xref ref-type="bibr" rid="CR1">1</xref>], the published literature in this domain has undergone exponential growth. The number of peer-reviewed journal publications has nearly doubled, ever expanding the breadth and scope of the applications of 3D printing in medicine. It is evident that 3D printing is poised to play an important role in transforming the practice of medicine, with applications ranging from fabrication of simple tools to complex tissues and, eventually, organs. Development of familiarity with 3D printing may therefore be of considerable interest to a wide range of medical professionals.</p><p>The term &#x0201c;3D printing&#x0201d; has evolved to become synonymous with the terms &#x0201c;rapid prototyping&#x0201d; and &#x0201c;additive manufacturing&#x0201d; within the medical domain, and refers to the process of fabrication of 3D objects through sequential deposition and fusion of matter in a layer-by-layer fashion [<xref ref-type="bibr" rid="CR2">2</xref>]. A wide range of printing technologies are available to enable the fabrication of 3D models in a range of materials, including plastics, metal alloys, ceramics, and numerous biological substrates supporting living cells. While a more detailed examination of these technologies is covered at length elsewhere, it must be noted that this diversity enables a tremendous range of applications at numerous levels of cost, accuracy, durability, build time, and biocompatibility. Medical 3D printing is therefore nearly universally accessible and applicable.</p><p>The process of 3D printing starts with the generation of a printable model in a process that is not entirely dissimilar to typical 3D reconstructions. Typically, cross-sectional imaging is used as an initial step in model creation. Computed Tomography (CT), by virtue of reflecting changes in a single parameter (attenuation), is the preferred modality for this purpose. The acquisition of images specifically for the purposes of 3D printing requires minimizing the size of voxels within the reconstructed images while optimizing contrast administration for adequate visualization of the relevant anatomy.</p><p>Once appropriate images are acquired, segmentation, or isolation of the relevant anatomy is undertaken using methodology that is akin to 3D visualization methods available in most radiology departments. The process of segmentation involves creating a set of criteria for the voxels to satisfy in order to be included in a model. These criteria may include connectivity to a seed point, attenuation coefficient within a specific range, or presence within specific manually defined geometric boundaries. Such selection criteria may be set manually or specified automatically as part of applying a segmentation algorithm.</p><p>While 3D visualization typically ends at selecting and displaying a set of segmented voxels, further additional model manipulations are required to enable 3D printing. Fundamentally, the collection of voxels occupying a specific set of Cartesian coordinates within a region of interest (ROI) needs to be transformed into a 3D object in a process referred to as <italic>tessellation</italic>. Tessellation is widely used in computer graphics to approximate shapes using a set of triangles. The more triangles are used, the more refined a shape becomes. Unfortunately, transformation into a 3D object does not ensure model printability or stability. For instance, it may be necessary for the model to be further smoothed, non-printable parts may be removed or mathematically adjusted, and vulnerable areas may be reinforced using a range of automated algorithms.</p><p>Further manipulations using Computer-Aided Design (CAD) software may be necessary to enable the development of patient-specific instrumentation, implants, or reconstructions. Given the ubiquity of such tasks, this course will focus not only on segmentation of patient anatomy, but also the <italic>de novo</italic> creation of personalized medical models.</p><p>The principles of 3D printing in medicine are best appreciated through practical hands-on experiences covering a broad range of applications. Therefore, this guide will provide the foundational knowledge to broadly cover the segmentation of relevant anatomy on CT-derived Digital Imaging and Communications in Medicine (DICOM) images followed by 3D printable model creation and concluded by patient-specific reconstructions and surgical guide design.</p><p>The United States Food and Drug Administration (FDA) classifies medical 3D printing software into <italic>design manipulation software</italic> that enables medical device design and modification and <italic>build preparation software</italic> that enables the conversion of the digital design into a file format that is 3D printable, or Standard Tessellation Language, or STL file in this case [<xref ref-type="bibr" rid="CR3">3</xref>]. To illustrate the use of the former, we shall apply Mimics inPrint and 3-matic Medical software (Materialise, Leuven, Belgium) while the latter will be represented by Polyjet Studio (Stratasys Ltd., MN, USA).</p><p>The Mimics inPrint software facilitates the processing of 2D image data acquired from axial imaging (CT, MRI) in order to create 3D printable models. While the vast majority of functionality is present in this accessible package, certain higher-order operations, including various segmentation algorithms present in more advanced packages such as Mimics (Materialise, Leuven, Belgium), are omitted for simplicity and accessibility.</p><p>3-matic Medical is a CAD package tailored for design of medically relevant models. This software enables the manipulation of patient-derived 3D models as well as creation and redesign of entirely new models in the context of patient anatomy. The application of this package in anatomical reconstruction and medical device creation will be explored in this work.</p><p>Finally, Polyjet studio enables the preparation of the 3D models represented as a set of connected triangles in an STL file format for printing on a commercial 3D printer. This software enables the exploration of factors such as part placement, material costs, build times, and material selection in order to optimize the 3D printing process. While the Polyjet studio is dedicated specifically to Polyjet printers capable of producing multi-colored prints, the general interface and approach are fairly representative of the experience in setting up a 3D printing task.</p><p>In the first case, we shall examine two common scenarios where 3D printing holds the potential of improving patient care: pre-procedure planning for vascular interventions with an example of iliac artery aneurysm repair and creation of surgical tools for neoplasm resection on a patient with a large pleomorphic sarcoma.</p><p>Iliac artery aneurysms are mostly seen in association with aortic aneurysms. Isolated iliac artery aneurysms are rare, involving &#x0003c;0.1&#x000a0;% of population [<xref ref-type="bibr" rid="CR4">4</xref>]. Most common etiology is atherosclerosis, while less common causes include connective tissue disorders, trauma, dissection, or infection. The most commonly involved site is the common iliac artery, followed by the internal iliac artery [<xref ref-type="bibr" rid="CR5">5</xref>]. Aneurysms of external iliac artery are relatively rare.</p><p>Although most patients are asymptomatic, some present with symptoms due to mass effect on adjacent ureters, nerves, or veins. Rarely, aneurysmal rupture will lead to an acute presentation. Asymptomatic aneurysms are treated when they enlarge beyond 3&#x02013;3.5&#x000a0;cm in diameter or if they become symptomatic [<xref ref-type="bibr" rid="CR6">6</xref>&#x02013;<xref ref-type="bibr" rid="CR8">8</xref>]. Although treatment can be performed by open surgery or by an endovascular approach, the latter is presently favored due to its safety and lower complication rates, except in patients with compressive symptoms [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>].</p><p>Depending on the location and extent of the aneurysm, endovascular treatment involves deployment of stent graft with or without internal iliac artery embolization or surgical bypass. Since internal iliac embolization can lead to complications including buttock claudication, bowel ischemia, sexual dysfunction, and tissue necrosis, branch iliac artery grafts are also used to preserve flow, especially while treating bilateral aneurysms.</p><p>An initial CT angiogram is performed prior to the procedure to define the anatomy and select the appropriate device. Pertinent information sought includes assessment of access (common femoral artery) for its diameter (large enough to accommodate delivery system), presence of plaques or calcifications, which can hinder access. Iliac artery diameters at landing zones (typically 15&#x02013;20&#x000a0;mm length) are measured in true short axis using multiplanar reconstructions to select the size of the stent graft (typically oversized by 10- 15&#x000a0;% or as per manufacturer&#x02019;s recommendation). Iliac vessel tortuosity is also assessed as it can pose a challenge during the procedure.</p><p>A 3D printed model can therefore be quite beneficial in preoperative planning and teaching of aneurysm repairs. The aneurysm model produced using this process may be used to demonstrate the mechanism of stent deployment in endovascular aneurysm repair. Using this case as a guide, learners will become familiar with segmentation techniques used routinely in 3D printing to expose relevant anatomy, as well as extrusion techniques necessary to reconstruct the anatomy of any contrast-opacified structure, including vasculature, heart, or hollow viscus.</p><p>The second case demonstrates the design and surgical planning involved in the creation of a prosthetic hip implant for a patient with an extensive lytic lesion within the left iliac crest secondary to a soft tissue sarcoma. This patient was diagnosed with undifferentiated pleomorphic sarcoma (giant cell subtype).</p><p>Pleomorphic sarcoma is the most common type of high grade soft tissue sarcoma in the adults [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. It often presents as an aggressive, large, high grade sarcoma of the extremity. Prognostic risk factors include tumor size, depth, and proximal location. This soft tissue sarcoma is thought to be derived from a primitive mesenchymal cell capable of differentiating into histiocytes, fibroblasts, myofibroblasts, and osteoclasts. The etiology of the tumor remains unknown. Prior radiation therapy is likely a risk factor. The most common clinical presentation is an enlarging painless soft-tissue mass in the thigh, typically 5&#x02013;10&#x000a0;cm in diameter. The majority of tumors are intramuscular.</p><p>When it arises within the pelvis, detection may be limited due to its deep location, and the patient may only seek medical attention when the tumor is quite large. Although it may metastasize to lungs or local lymph nodes, this neoplasm typically expands and recurs regionally to produce a lesion which may visually appear to be well circumscribed but may actually have extensive soft tissue invasion [<xref ref-type="bibr" rid="CR11">11</xref>]. The treatment of choice is wide local excision with adjuvant radio- and chemotherapy, for a cumulative 5&#x000a0;year survival on the order of 50&#x02013;60&#x000a0;% of all high-grade pleomorphic sarcomas [<xref ref-type="bibr" rid="CR13">13</xref>&#x02013;<xref ref-type="bibr" rid="CR15">15</xref>].</p><p>The patient presented here (patient TCGA-QQ-A5V2, The Cancer Imaging Archive [<xref ref-type="bibr" rid="CR16">16</xref>]) has wide involvement of the iliac crest and the wide excision would be planned using a custom cutting guide, followed by reconstruction of the excised bone fragment using a customized titanium implant (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). The design of the implant will be based on the disease-free hemipelvis.<fig id="Fig1"><label>Fig. 1</label><caption><p>Simplified overview of pleomorphic sarcoma supported in this work. After identifying the extent of the neoplasm (left, red), it is resected with wide margins. The skeletal defect is filled using a patient-specific implant (right)</p></caption><graphic xlink:href="41205_2016_8_Fig1_HTML" id="MO1"/></fig>
</p><p>This case will primarily focus on CAD software (3-matic) to introduce the learners to the patient-specific surgical planning and reconstruction principles that may then be adapted to a wide range of cases, ranging from craniotomy implants to surgical planning with custom guides for osteotomies involving all bones of the appendicular and axial skeleton.</p><p>Prior to beginning the learning modules, the reader is directed to an overview of Mimics inPrint software and controls (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Overview of the Mimics inPrint project screen</p></caption><graphic xlink:href="41205_2016_8_Fig2_HTML" id="MO2"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Mimics inPrint keyboard and mouse shortcuts</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th>Shortcut</th><th>Action</th></tr></thead><tbody><tr valign="top"><td>Scroll Wheel Drag (2D View)<break/>OR Shift right click&#x02009;+&#x02009;drag</td><td>Pan: Move the mouse while keeping the center button pressed</td></tr><tr valign="top"><td>Right Click&#x02009;+&#x02009;Drag<break/>(2D View)</td><td>Zoom: click and drag the right mouse button to zoom in and out.</td></tr><tr valign="top"><td>Arrow Up/Scroll Up (2D View)</td><td>Go to next slice</td></tr><tr valign="top"><td>Arrow Down/Scroll Down (2D View)</td><td>Go to previous slice</td></tr><tr valign="top"><td>Page Up (2D View)</td><td>Skip 10 slices upward</td></tr><tr valign="top"><td>Page Down (2D View)</td><td>Skip 10 slices downward</td></tr><tr valign="top"><td>Hover mouse over a view, then SPACE</td><td>Change chosen image to/from full screen.</td></tr><tr valign="top"><td>Backspace</td><td>Switch between two window states</td></tr><tr valign="top"><td>CTRL&#x02009;+&#x02009;Z (Everywhere)</td><td>Undo the previous action.</td></tr><tr valign="top"><td>CTRL&#x02009;+&#x02009;Right Click&#x02009;+&#x02009;Drag (2D View)</td><td>Adjusts contrast window in images</td></tr><tr valign="top"><td>Right Click&#x02009;+&#x02009;Drag (3D View)</td><td>Rotate a 3D shape.</td></tr><tr valign="top"><td>CTRL&#x02009;+&#x02009;Right Click&#x02009;+&#x02009;Drag (3D View)</td><td>Zoom into or out of 3D shape.</td></tr><tr valign="top"><td>Shift&#x02009;+&#x02009;Right Click&#x02009;+&#x02009;Drag (3D View)</td><td>Pan the 3D shape around a scene.</td></tr></tbody></table></table-wrap>
</p><sec id="Sec2"><title>Patient 1: endovascular aneurysm repair simulation</title><sec id="Sec3"><title>Task A: segmentation</title><p>
<disp-quote><p>WHAT YOU ARE DOING: Segmenting the aorta and iliac vessels as well as the bones. In <bold><italic>segmentation</italic></bold>, specific voxels satisfying specific attenuation criteria are selected to create a region of interest. You will isolate the vessels and bones in this step.</p><p>WHY YOU ARE DOING IT: To identify the voxels for conversion into a 3D model.</p><p>HOW TO DO IT: We will be using a widely available tool, <bold><italic>Thresholding</italic></bold>, to select the desired voxels based on attenuation within a specified Hounsfield Unit (HU) range. This step will create a <bold><italic>Region of Interest (ROI)</italic></bold>, an intermediate model that requires further manipulations to be printed. A list of the ROIs you have created appears in the first pane of the Project Management Toolbar (bottom left).</p></disp-quote>
</p><p>We shall begin by importing the images into our project from a DICOM folder. The DICOM data can be obtained from the OsiriX DICOM image library [<xref ref-type="bibr" rid="CR17">17</xref>]. To do this, select the <bold>File</bold> menu, then <bold>New From Disk</bold>, followed by selecting the <bold>DICOM Data</bold> folder, pressing the <bold>Next</bold> button in the dialog that appears, and finally <bold>Convert</bold>. This will load all the DICOM images into the workspace.</p><p>In order to segment the aorta and the iliac vessels, select Thresholding (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Thresholding function (1) within the Guided Segmentation menu</p></caption><graphic xlink:href="41205_2016_8_Fig3_HTML" id="MO3"/></fig>
</p><p>This will bring you to a menu that allows you to provide the HU range for the anatomy of interest. Since we would like to select contrast-enhanced vessels while avoiding bones and soft tissues, we will define a fairly narrow range of values, from 140 to 250 (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). Rename the ROI to <bold><italic>Contrast</italic></bold>, and select in the options to keep only the largest region and fill holes in the ROI. This will provide us with the smoothest contiguous model possible.<fig id="Fig4"><label>Fig. 4</label><caption><p>Settings for minimal (1) and maximal (2) attenuation thresholds, naming the ROI (3), and options (4)</p></caption><graphic xlink:href="41205_2016_8_Fig4_HTML" id="MO4"/></fig>
</p><p>After the settings for segmentation are in order, adjust the segmentation box by moving its outlines on the sagittal view to only include the relevant pelvis and lower abdomen. Specifically, move the superior boundary to the L3-L4 disk level, posterior to S1-S2 level, and inferior to just below the inferior pubic rami (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). Anterior adjustments are not necessary.<fig id="Fig5"><label>Fig. 5</label><caption><p>Adjustments for the bounding box for the segmentation in the sagittal midline (1&#x02013;4)</p></caption><graphic xlink:href="41205_2016_8_Fig5_HTML" id="MO5"/></fig>
</p><p>Click the checkmark in the thresholding setup. After calculations complete, the ROI will be revealed in the 3D View (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>). The inferior abdominal aorta and its branches are quite well resolved in the resultant ROI, though you will notice that the segmentation is incomplete as remnants of the sacrum require separation from the vasculature.<fig id="Fig6"><label>Fig. 6</label><caption><p>Intermediate segmentation ROI demonstrates the mesenteric artery (1), large bilateral common iliac artery aneurysms (2), superior gluteal arteries (3), as well as the origin of the deep femoral and femoral circumflex arteries bilaterally (4). Note the remnants of the sacrum (5) which need to be separated from the vascular structures</p></caption><graphic xlink:href="41205_2016_8_Fig6_HTML" id="MO6"/></fig>
</p><p>In order to remove the remnants of the sacrum from our ROI, we will use the <bold>Split</bold> tool in the <bold>Edit ROI</bold> menu (Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>). This tool allows us to define a <bold>Foreground</bold>, or all structures to be included in the ROI and a <bold>Background</bold>, or all structures to exclude.<fig id="Fig7"><label>Fig. 7</label><caption><p>The Edit ROI menu (1) and the Split tool (2)</p></caption><graphic xlink:href="41205_2016_8_Fig7_HTML" id="MO7"/></fig>
<disp-quote><p>
<bold><italic>Segmentation</italic></bold>
</p><p>Segmentation is a task that simply creates a set of criteria for voxels to fulfil in order to be included in a model. The first set is created by the <bold><italic>thresholding</italic></bold> function &#x02013; a range of HU values are set to select the relevant voxels. When we decided to &#x0201c;<bold><italic>keep the largest region</italic></bold>&#x0201d; after thresholding, we selected the largest set of contiguous voxels. With the split function, we are providing a number of seed points for the software to automatically extend in order to create two dissimilar contiguous regions, separating the anatomy we wish to see in our model from the background.</p></disp-quote>
</p><p>In order to do this, first ensure that the Contrast ROI is selected, choose an axial image that shows both, the vascular structure ROI to be included and the skeletal structures to be excluded at the level of the right common iliac artery bifurcation (axial image annotated 397.5 in left lower corner) and paint the foreground (ROI volume to remain in the model) as well as the background (ROI volume to remove) on this axial image (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>). Once this is complete, ensure you <bold>create result in new ROI</bold>, name the ROI &#x0201c;Contrast Separated&#x0201d; (5), and press the green checkmark. If you have done this correctly, a new ROI comprised only of vascular structures will appear, as shown.<fig id="Fig8"><label>Fig. 8</label><caption><p>Selecting the Contrast ROI (1), moving to the bifurcation of the right common iliac artery (2) and selecting the foreground (3) and background (4) structures to create a new separated ROI (5), right</p></caption><graphic xlink:href="41205_2016_8_Fig8_HTML" id="MO8"/></fig>
</p><p>Note: <italic>To expand the axial image window to the full screen, simply press the spacebar while hovering over it with your mouse.</italic>
</p><p>Thus far, we have <italic>segmented</italic> the contrast-opacified arteries within the patient&#x02019;s lower abdomen and pelvis. This has created an <italic>ROI</italic> or <italic>mask</italic>, which is simply a collection of voxels that satisfy a set of criteria, which in this case constitute 1) 140-250HU density range, 2) membership within the largest contiguous collection of voxels satisfying density criteria, and 3) algorithmic separation of ROI based on user input. This is quite similar to segmentation that is typically performed in 3D rendering on a daily basis. Note that this collection of voxels is not yet a 3D printable model. In order to create a printable model, we need to convert this collection of voxels into an STL model and verify that this STL model is printable.</p></sec><sec id="Sec4"><title>Task B: creation of prinable STL models</title><p>
<disp-quote><p>
<bold><italic>What are STL models?</italic></bold>
</p><p>STL models define a 3D geometry as a collection of triangles that collectively describe a shape. As the number of triangles used increases, the approximation of reality by the model improves, but the model becomes more computationally expensive to create and manipulate. The mere act of describing a model as a set of triangles does not ensure printability, however. Further processing is required to ensure that the shapes that are represented in the STL model are <italic>manifold</italic> shapes and can exist as non-abstract geometrical constructs. While this is outside the scope of this tutorial, non-manifold shapes include entities such as planes, lines, and points, which have no thickness, cannot exist in the real world, and will likely lead to errors in printing.</p></disp-quote>
</p><p>To create an STL model of the vessels, we will simply use the <italic>Add Part</italic> function to create a <italic>Hollow Part</italic> (Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>). Creating a hollow part as opposed to a solid part allows us to model vessels by creating a 1.5&#x000a0;mm wall around the intraluminal contrast we have just segmented.<fig id="Fig9"><label>Fig. 9</label><caption><p>Add part menu (1) and the Hollow Part function (2)</p></caption><graphic xlink:href="41205_2016_8_Fig9_HTML" id="MO9"/></fig>
</p><p>In the <bold>Hollow Part</bold> dialog that appears, we will ensure that the ROI we have created is selected (Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>), then select an outward direction to create walls <italic>outside</italic> the contrast ROI, set wall thickness to an arbitrary value of 1.5&#x000a0;mm, smoothing to High, and click the green checkmark.<fig id="Fig10"><label>Fig. 10</label><caption><p>Selecting the ROI (1) and setting the parameters (2&#x02013;4) for hollow part creation</p></caption><graphic xlink:href="41205_2016_8_Fig10_HTML" id="MO10"/></fig>
</p><p>This will create an STL model, also known as a <italic>Part</italic> within the inPrint software. The ROI will be hidden at the end of the operation, as denoted by the crossed out eye within the list of ROIs, and a new part named <italic>Contrast Separated</italic> will appear (Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref>). The software automatically opens the <italic>Edit Part</italic> section.<fig id="Fig11"><label>Fig. 11</label><caption><p>The ROI is hidden (1) and a part is created (2) which will then be edited (3) using the Cut function (4)</p></caption><graphic xlink:href="41205_2016_8_Fig11_HTML" id="MO11"/></fig>
</p><p>To reflect the transformation of the model, rename part we just created from &#x0201c;Contrast Separated&#x0201d; to &#x0201c;Arteries&#x0201d; by single-clicking the text label of the part that was just created, typing its new name, and pressing <bold><italic>Enter</italic></bold> on the keyboard (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>).<fig id="Fig12"><label>Fig. 12</label><caption><p>Renaming an ROI</p></caption><graphic xlink:href="41205_2016_8_Fig12_HTML" id="MO12"/></fig>
</p><p>After inspecting the model, you will notice that a uniform wall was made around the intraluminal contrast ROI. Since we would like to simulate stent placement, it is necessary to open the vessels by cutting off the closed ends. To do this, select the <bold>Cut</bold> function.</p><p>We will first reorient the model so that we are looking at it face-on to allow us to perform a smoother cut in one plane. For this, use the <bold>View</bold> menu, and navigate to <bold>3D Viewports&#x02009;&#x0003e;&#x02009;Views&#x02009;&#x0003e;&#x02009;Front</bold>. Then, in the <bold>Cut</bold> dialog (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>), ensure that the <italic>Arteries</italic> part is selected, select the option to remove the inner part of the selection you highlight, and draw a rectangle around the three vessel ends, pressing the green checkmark for each individual cut to carry out the procedure (Fig.&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref>).<fig id="Fig13"><label>Fig. 13</label><caption><p>Selecting the Arteries part (1) and removing the inner part (2) of rectangular selections at the proximal and distal ends of the part (3)</p></caption><graphic xlink:href="41205_2016_8_Fig13_HTML" id="MO13"/></fig>
</p><p>With the completion of this task, you should be able to explore the model and look inside the simulated vessels (Fig.&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref>). The vascular model is now complete. Detailed instructions regarding model printing are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.<fig id="Fig14"><label>Fig. 14</label><caption><p>Completed model of the vasculature including the iliac aneurysms</p></caption><graphic xlink:href="41205_2016_8_Fig14_HTML" id="MO14"/></fig>
</p></sec></sec><sec id="Sec5"><title>Patient 2: soft tissue sarcoma excision and personalized implant design</title><p>For this patient with extensive soft tissue sarcoma invading into the osseous structures of the pelvis, we shall first need to design a patient-specific prosthetic implant. To do this, we would require to mirror and duplicate the healthy hemipelvis exactly at the point of excision. In order to allow for precise excision that spares healthy tissue, we would also need to create cutting guides to direct the wide excision of this neoplasm in a manner that allows subsequent placement of the custom implant flush with the excision site while optimizing the resection volume.</p><p>The images for this project may be obtained from the Cancer Imaging Archive [<xref ref-type="bibr" rid="CR16">16</xref>] by searching for the patient TCGA-QQ-A5V2 and retrieving corresponding CT images (no direct link is available). The preparation of these CT images for segmentation is identical to that in Task A for Patient 1.</p><sec id="Sec6"><title>Task A: segmentation</title><p>To begin operative planning, we will first need to visualize the involvement of the skeletal structures of the pelvis with the large soft tissue sarcoma by thresholding between 250HU and 1520HU and limiting the bounding box at the L3-L4 intervertebral disk proximally. The steps for this are identical to those in Task A for Patient 1. Limiting the bounding box in any other dimension is not necessary. If you have successfully completed these steps, you will be able to obtain a model similar to Fig.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref>. Name your ROI <bold>Skeletal</bold>.<fig id="Fig15"><label>Fig. 15</label><caption><p>Result of bone segmentation. Note the missing left iliac crest (lower left image)</p></caption><graphic xlink:href="41205_2016_8_Fig15_HTML" id="MO15"/></fig>
</p></sec><sec id="Sec7"><title>Task B: isolation of relevant pathology</title><p>In this step, our goal is to isolate only the iliac bones. We will take advantage of the Mimics inPrint <bold>Split</bold> function as we did earlier, within the <bold>Edit ROI</bold> menu. With this tool, ensure that the <bold>Skeletal</bold> ROI appears in the Selection list as before. The <bold>Foreground</bold> brush will again be used to paint all structures that should be preserved, while the <bold>Background</bold> brush will be used to indicate structures to reject (Fig.&#x000a0;<xref rid="Fig16" ref-type="fig">16</xref>).<fig id="Fig16"><label>Fig. 16</label><caption><p>Two isolated levels demonstrating the foreground (blue) and background (black) selection</p></caption><graphic xlink:href="41205_2016_8_Fig16_HTML" id="MO16"/></fig>
</p><p>The axial view is best suited for selection of the background (rejected) and foreground (desirable) features in this case. The sacrum will be the background, while the remainder of the bones of the pelvis will be the foreground. You need not paint all of the axial images &#x02013; two well-placed images will typically suffice. If your selection results in more remnant fragments than necessary, more axial images may be annotated. After you are satisfied with your result, press the green checkmark in the <bold>Split</bold> dialog.</p><p>Upon the completion of the operation, you shall see that the separation product in the ROI list and the 3D view (Fig.&#x000a0;<xref rid="Fig17" ref-type="fig">17</xref>). In the resultant model, the femurs are still in place&#x02014;these will be useful for alignment at a later time.<fig id="Fig17"><label>Fig. 17</label><caption><p>Result of applying the Split function to the pelvis, separating the sacrum from the iliac bones</p></caption><graphic xlink:href="41205_2016_8_Fig17_HTML" id="MO17"/></fig>
</p><p>Transitioning to an STL model, we shall now create a part using the <bold>Add Part</bold> menu, this time generating a <bold>Solid Part</bold> with <bold>High</bold> smoothing, as shown earlier, making sure that the <bold>Skeletal</bold> ROI appears in the list. This will generate a smoothed STL model ready for further processing (Fig.&#x000a0;<xref rid="Fig18" ref-type="fig">18</xref>).<fig id="Fig18"><label>Fig. 18</label><caption><p>Separation of the left and right hemipelvis along the symphysis pubis</p></caption><graphic xlink:href="41205_2016_8_Fig18_HTML" id="MO18"/></fig>
</p></sec><sec id="Sec8"><title>Task C: mirroring the healthy hemipelvis</title><p>
<disp-quote><p>
<bold><italic>Mirroring</italic></bold>
</p><p>Mirroring is a basic approach used in the reconstruction of patient anatomy in cases of severe pathologic unilateral deformities. Since humans exhibit plane symmetry through the midline sagittal plane, the non-pathologic side can be <italic>mirrored</italic> and computationally overlapped with the diseased side to provide rapid patient-specific reconstruction. This technique is widespread, from craniotomy plate creation to mandibular reconstruction, for example. In this work, we shall use the healthy hemipelvis as a template for the hemipelvis with the sarcoma. For this, we will need to first separate the two halves of the pelvis, and then reflect and overlap the healthy hemipelvis with the diseased one.</p></disp-quote>
</p><p>After the part has been created, the software will display the <bold>Edit Part</bold> menu. Here, we shall select to <bold>Cut</bold> the part into two. Before doing this, however, let us align the view to best prepare the cut. Go to <bold>View</bold> in the menu toolbar, and then select <bold>3D Viewports&#x02009;&#x0003e;&#x02009;Views&#x02009;&#x0003e;&#x02009;Front</bold>. Once this is set up, ensure that the <bold>Skeletal</bold> part is in the selection menu, that the <bold>Method</bold> is set to <bold>Cut</bold>, and draw a rectangle separating the two halves of the pelvis, as shown. Press the green checkmark button once this is complete.</p><p>This action will create two parts, <bold>Skeletal-inner</bold> and <bold>Skeletal-outer</bold>, which we will rename these parts <bold>Left</bold> and <bold>Right</bold> respectively (if you have set up the cut as in Fig.&#x000a0;<xref rid="Fig18" ref-type="fig">18</xref>), to reflect the anatomy. We shall first mirror the healthy right half to use as a template for the reconstructive implant. To do this, return to the <bold>Edit Part</bold> menu and select the <bold>Mirror</bold> function (Fig.&#x000a0;<xref rid="Fig19" ref-type="fig">19</xref>).<fig id="Fig19"><label>Fig. 19</label><caption><p>The Edit Part menu and the Mirror function</p></caption><graphic xlink:href="41205_2016_8_Fig19_HTML" id="MO19"/></fig>
</p><p>Select the healthy hemipelvis (<bold>Right</bold>) here and execute the mirroring by pressing the green checkmark (Fig.&#x000a0;<xref rid="Fig20" ref-type="fig">20</xref>). After this process is complete, delete the <bold>Right</bold> model by selecting it in the Parts list and pressing <bold>Delete</bold> on the keyboard.<fig id="Fig20"><label>Fig. 20</label><caption><p>Mirror menu selection and the result upon mirroring the right hemipelvis</p></caption><graphic xlink:href="41205_2016_8_Fig20_HTML" id="MO20"/></fig>
</p><p>You will notice that a <bold>Right_Mirrored</bold> part has now been created. Visualizing the two parts together as above, you will notice that their alignment is not complete, limiting implant creation. Computer Aided Design (CAD) software, <bold>3-matic</bold> will be necessary to complete this task. To transfer our work, simply save the project from the <bold>File</bold> menu.</p></sec><sec id="Sec9"><title>Task D: computer-aided implant design with 3-matic</title><p>The 3-matic CAD software contains powerful tools for editing any STL file in preparation for printing as well as for creation of new 3D printable parts. We will demonstrate several of these tools to familiarize you with the capabilities of this software. To retrieve the project in 3-matic, simply import the project saved earlier by pressing <bold>File&#x02009;&#x0003e;&#x02009;Import Part</bold> and locating the project in the dialogue that appears. This will open the two overlapping hemipelvis models created earlier, as shown (Fig.&#x000a0;<xref rid="Fig21" ref-type="fig">21</xref>).<fig id="Fig21"><label>Fig. 21</label><caption><p>Main window overview of 3-matic. Featured are the menu toolbar (1), 3D view (2), Object tree (3), Properties (4), and the Logger (5)</p></caption><graphic xlink:href="41205_2016_8_Fig21_HTML" id="MO21"/></fig>
</p><p>You will notice that the 3-matic window has a <bold>Menu Bar</bold> where its numerous functions can be found, a <bold>3D view</bold> to visualize the selected models, <bold>Object Tree</bold> where the manipulated models appear, <bold>Operations Tab</bold> which allows us to set parameters for various functions, and the <bold>Logger</bold> to display pertinent status updates (Fig.&#x000a0;<xref rid="Fig21" ref-type="fig">21</xref>).</p><p>The Mimics inPrint work stopped when we discovered imperfections in the alignment of the two models. Fortunately, 3-matic has a built-in function to align two models: select <bold>Align&#x02009;&#x0003e;&#x02009;Global Registration</bold> on the menu bar. In the <bold>Operations Tab</bold> for the Global Registration function, select the <bold>Fixed entity</bold> to be the <bold>Left</bold> hemipelvis, the <bold>Moving entity</bold> to be the mirrored <bold>Right</bold> hemipelvis, and set the parameters as shown, with distance threshold of 10 and number of iterations at 25. Press apply (Fig.&#x000a0;<xref rid="Fig22" ref-type="fig">22</xref>).<fig id="Fig22"><label>Fig. 22</label><caption><p>Global Registration alignment operation setup</p></caption><graphic xlink:href="41205_2016_8_Fig22_HTML" id="MO22"/></fig>
</p><p>Once the process completes, you will see excellent alignment of the two models. Right-click the <bold>Right</bold> model on the object tree and select <bold>View&#x02009;&#x0003e;&#x02009;Transparency&#x02009;&#x0003e;&#x02009;High</bold> to better visualize the overlap of the two parts (Fig.&#x000a0;<xref rid="Fig23" ref-type="fig">23</xref>).<fig id="Fig23"><label>Fig. 23</label><caption><p>Overlapping hemipelvis models</p></caption><graphic xlink:href="41205_2016_8_Fig23_HTML" id="MO23"/></fig>
</p><p>Now that the two models are overlapping, we shall plan the surgical cut. First, set the view to the right (<bold>View&#x02009;&#x0003e;&#x02009;Default Views&#x02009;&#x0003e;&#x02009;Right)</bold>&#x02014;this will allow us to standardize our cut while ensuring that the cutting planes are orthogonal to the ZY plane. Select the <bold>Trim</bold> function from the <bold>Finish</bold> menu and set it up to <bold>preserve inner and outer</bold> fragments and to operate on both parts of the pelvis, as shown. Press <bold>Apply</bold> when ready (Fig.&#x000a0;<xref rid="Fig24" ref-type="fig">24</xref>).<fig id="Fig24"><label>Fig. 24</label><caption><p>Setting up the trim operation to plan surgical excision</p></caption><graphic xlink:href="41205_2016_8_Fig24_HTML" id="MO24"/></fig>
</p><p>This will create four fragments from the previous two. Deleting the two unnecessary fragments&#x02014;the resected tumor and the unused part of the healthy hemipelvis by selecting them on the Object Tree and pressing <bold>Delete</bold> on the keyboard, we can appreciate the excellent alignment of the newly designed custom implant (beige) in relation to the diseased hemipelvis (black) (Fig.&#x000a0;<xref rid="Fig25" ref-type="fig">25</xref>). If this alignment is unsatisfactory in your case, fine adjustments may be carried out by scaling, rotating, and translating the implant model as needed within 3-matic.<fig id="Fig25"><label>Fig. 25</label><caption><p>The healthy portion of the right hemipelvis (black) and the implant (beige)</p></caption><graphic xlink:href="41205_2016_8_Fig25_HTML" id="MO25"/></fig>
</p></sec><sec id="Sec10"><title>Task E: computer-aided cutting guide design</title><p>Let us now take a moment to rename all model parts for clarity. Select the smaller part of the <bold>Right_Mirrored</bold> model and rename it to <bold><italic>Implant</italic></bold>. To do this, simply single-click the name of this object in the Object Tree so that it changes to an editable field, type in the new name and press <bold>Enter</bold>. This is the reconstructed, patient-specific implant that will be printed in titanium and implanted after the resection. Because we have completed our manipulations with it, we shall now hide it by right-clicking it in the Object Tree and selecting <bold>Hide</bold>. Likewise, rename the healthy part of the left hemipelvis as <bold>Left</bold>. The object tree should therefore contain only two parts: <bold>Left</bold> and <bold>Implant</bold>.</p><p>We shall now create a surgical guide for more precise excision of the diseased portion of the left hemipelvis, using the patient&#x02019;s own hip geometry. To do this, we shall first return to the Right view (<bold>View&#x02009;&#x0003e;&#x02009;Default Views&#x02009;&#x0003e;&#x02009;Right</bold>). We shall then <bold>Wrap</bold>, <bold>Cut</bold>, <bold>Translate</bold>, and finally carry out a <bold>Boolean Subtraction</bold> on the left hemipelvis to create the beginning of a simple surgical template to guide the excision.<disp-quote><p>
<bold><italic>Wrapping Operation</italic></bold>
</p><p>The wrapping operation fills all holes and defects inside our model and creates a solitary watertight surface that would be easily amenable to 3D printing. In this operation, the model is checked to ensure that non non-manifold geometry is present in it. This is important because all objects within the real world are manifold: it is impossible to manufacture a perfect plane (single fold) of 0 thickness, or two shapes that touch in a single, mathematically discrete dot &#x02013; these are abstract concepts. The wrapping operation ensures that the geometry of our model is not only watertight, devoid of internal cavities, and smooth, but also that it can exist in the real world!</p></disp-quote>
</p><p>Select <bold>Fix&#x02009;&#x0003e;&#x02009;Wrap</bold> from the menu bar and set up the Wrap function as shown. In several seconds, this operation will remove any holes within the model that are below 15&#x000a0;mm wide (gap closing distance), while smoothing all imperfections that are smaller than 0.75&#x000a0;mm (Fig.&#x000a0;<xref rid="Fig26" ref-type="fig">26</xref>).<fig id="Fig26"><label>Fig. 26</label><caption><p>Setup of the wrapping operation</p></caption><graphic xlink:href="41205_2016_8_Fig26_HTML" id="MO26"/></fig>
</p><p>This operation will result in a new wrapped model, <bold>Left_wrapped</bold>. Hide the <bold>Left</bold> model and duplicate the <bold>Left_wrapped</bold> model by right-clicking it and selecting <bold>Duplicate</bold>. We will now operate on this duplicated model (<bold>Left_wrapped_duplicate</bold>) to create a surgical guide that adheres to patient anatomy.</p><p>Hide the <bold>Left_wrapped</bold> model and select the <bold>Trim</bold> function from the <bold>Finish</bold> menu. Reset the view of your model to <bold>Right</bold> (<bold>View&#x02009;&#x0003e;&#x02009;Default Views&#x02009;&#x0003e;&#x02009;Right</bold>) so that we are again creating cuts within the ZY plane. The reason for this will become apparent in a moment.<disp-quote><p>
<bold><italic>Landmarks and the Surgical Guide: Notes from the OR</italic></bold>
</p><p>In our case, the orthopaedic surgeon consulted for this case would like to position the patient in the <bold>right lateral decubitus</bold> position. This exposes the lateral border of the left pelvis for resection. The surgeon would then proceed to resect the diseased soft tissue and <bold>dissect</bold> the healthy musculature from the <bold>smallest possible portion</bold> of the lateral aspect of the iliac bone. In doing so, the surgeon would attempt to preserve the abdominal wall if possible, while <bold>minimizing</bold> the amount of muscle tissue detached from the lateral aspect of the left pelvic bone while skeletonizing it. The surgeon would then prefer to use the <bold>anterior superior iliac spine</bold> as the first and most obvious landmark for surgical guide placement, followed by the <bold>posterior superior iliac spine</bold> as the second point of alignment. If the surface of the surgical guide conforms to the lateral surface of the iliac bone while leaving a <bold>1&#x000a0;mm margin of error</bold> for anticipated minimal imperfections while skeletonizing it, the surgical guide is anticipated to fit adequately. Once aligned to all landmarks, the <bold>inscriptions on the implant</bold> are again verified to ensure appropriate placement. The guide is then secured in place by <bold>positioning pins</bold> placed within <bold>appropriate holes</bold> placed on the implant at the design stage, and the guided osteotomy can begin.</p></disp-quote>
</p><p>Since we would like to include the anterior superior iliac spine (ASIS) and the posterior superior iliac spine (PSIS) as landmarks within our surgical guide while minimizing the amount of soft tissue resected to accommodate our guide, we will have to <bold>trim</bold> our model accordingly. Select the <bold>Trim</bold> function from the <bold>Finish</bold> menu and draw the boundaries (Fig.&#x000a0;<xref rid="Fig27" ref-type="fig">27</xref>). Ensure that the wrapped model duplicate appears in the Entities list and select &#x02018;<bold>Remove outer&#x02019;</bold> as the trimming method.<fig id="Fig27"><label>Fig. 27</label><caption><p>Intermediate step in creating the surgical guide, trimming</p></caption><graphic xlink:href="41205_2016_8_Fig27_HTML" id="MO27"/></fig>
</p><p>This will produce a fragment that now resembles a surgical guide (Fig.&#x000a0;<xref rid="Fig28" ref-type="fig">28</xref>).<fig id="Fig28"><label>Fig. 28</label><caption><p>Result of trimming the left hemipelvis to sculpt a surgical guide</p></caption><graphic xlink:href="41205_2016_8_Fig28_HTML" id="MO28"/></fig>
</p><p>We shall now use this fragment to carry out a <bold>Boolean subtraction</bold>, which will create a fragment that adheres to the lateral surface of the iliac bone and mimics the patient&#x02019;s anatomy closely, assisting the surgeon in its placement. Therefore, we will simply <bold>move</bold> this fragment lateral to the iliac bone and then <bold>remove its overlap</bold> with the iliac bone, leaving a 1&#x000a0;mm margin to accommodate any imperfections of surgical resection.</p><p>First, use the <bold>Translate</bold> function from the <bold>Align</bold> menu (Fig.&#x000a0;<xref rid="Fig29" ref-type="fig">29</xref>). Ensure that the translation <bold>Method</bold> is set to &#x02018;Translation from point to point&#x02019;, the <bold>From</bold> point is set at the origin (0,0,0) while the <bold>To</bold> point is set 10&#x000a0;mm in the positive direction along the X axis (10,0,0). Because we only cut our models orthogonally to the ZY plane earlier, this move is also orthogonal to the ZY plane and allows us to create a guide with a lateral surface parallel to that of the iliac bone and a guiding surface that is parallel to the direction of the osteotomy saw. Effectively, this ensures the best alignment while allowing the osteotomy saw to rest against the guide, assuring the excision is performed as planned. Press <bold>Apply</bold> and <bold>Show</bold> the <bold>Left_wrapped</bold> model (right click on it in the Object Tree and select <bold>Show</bold>). If performed correctly, you should see the two overlapping models.<fig id="Fig29"><label>Fig. 29</label><caption><p>Translating the surgical guide precursor and translation result</p></caption><graphic xlink:href="41205_2016_8_Fig29_HTML" id="MO29"/></fig>
</p><p>Now, we are able to carry out a <bold>Boolean Subtraction</bold> as shown (<bold>Design&#x02009;&#x0003e;&#x02009;Boolean Subtraction</bold>). To take into account imperfections of skeletonization of the iliac bone, ensure that <bold>Clearance</bold> is selected and set it to 1&#x000a0;mm as shown (Fig.&#x000a0;<xref rid="Fig30" ref-type="fig">30</xref>). This operation will remove the two models involved and will create instead a model called <bold>Subtraction result &#x02013; 001</bold>. Rename it now to <bold>Cutting Guide</bold> from the Object tree.<fig id="Fig30"><label>Fig. 30</label><caption><p>Boolean subtraction and its result</p></caption><graphic xlink:href="41205_2016_8_Fig30_HTML" id="MO30"/></fig>
</p><p>You will notice that this model contains a number of imperfections along its edge. To remove them, simply mark the fragment you would like to keep using the <bold>Mark&#x02009;&#x0003e;&#x02009;Shell</bold> operation, which will select the shell (collection of contiguous connected triangles) that corresponds to the surgical guide itself. Now, <bold>Mark&#x02009;&#x0003e;&#x02009;Invert</bold> the selection to select all the smaller shells to discard. Press the <bold>DEL</bold> key on the keyboard to delete these fragments (Fig.&#x000a0;<xref rid="Fig31" ref-type="fig">31</xref>).<fig id="Fig31"><label>Fig. 31</label><caption><p>Intermediate steps in clearing excess shell fragments</p></caption><graphic xlink:href="41205_2016_8_Fig31_HTML" id="MO31"/></fig>
</p><p>To visualize the results, <bold>Show</bold> the <bold>Left</bold> model from the <bold>Object Tree</bold> and explore the alignment. Once you are satisfied, visualize the implant by <bold>Showing</bold> it from the Object Tree as well. The guide and the implant are now complete, and with minimal further perfection with external labels and holes for positioning pins discussed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>, a surgical plan is complete and personalised medical instrumentation and implant can now be printed (Fig.&#x000a0;<xref rid="Fig32" ref-type="fig">32</xref>).<fig id="Fig32"><label>Fig. 32</label><caption><p>Result of guide creation (left) and the final model visualization after surgical guide annotation and pin position placement (right)</p></caption><graphic xlink:href="41205_2016_8_Fig32_HTML" id="MO32"/></fig>
</p><p>These models can now be exported as STL files (<bold>File&#x02009;&#x0003e;&#x02009;Export&#x02009;&#x0003e;&#x02009;STL</bold>) and printed. A further overview of 3D model printing is discussed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p></sec></sec></sec><sec id="Sec11"><title>Conclusion</title><p>As the applications of 3D printing in medicine continue to expand, familiarity with the basic operations and tasks involved in this process becomes increasingly important. By the virtue of their existing functions, some radiologists may very well subspecialize to emerge as physicians responsible for integrating the input from other specialists to design procedure guides and generate medical implants in the future. In this work, our goal has been to familiarize the medical professionals with this nascent field and start the dialogue in this revolutionary development in personalized medicine that has the potential of transforming the practice of medicine entirely.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec12"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41205_2016_8_MOESM1_ESM.docx"><label>Additional file 1:</label><caption><p>Printing a 3D Model with Polyjet Studio. (DOCX 1049 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41205_2016_8_MOESM2_ESM.docx"><label>Additional file 2:</label><caption><p>Creating Holes and Labeling. (DOCX 193 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>3D</term><def><p>Three dimensional</p></def></def-item><def-item><term>ASIS</term><def><p>Anterior superior iliac spine</p></def></def-item><def-item><term>CAD</term><def><p>Computer-aided design</p></def></def-item><def-item><term>CT</term><def><p>Computed tomography</p></def></def-item><def-item><term>DICOM</term><def><p>Digital imaging and communications in medicine</p></def></def-item><def-item><term>FDA</term><def><p>United States Food and Drug Administration</p></def></def-item><def-item><term>HU</term><def><p>Hounsfield units</p></def></def-item><def-item><term>MRI</term><def><p>Magnetic resonance imaging</p></def></def-item><def-item><term>ROI</term><def><p>Region of interest</p></def></def-item><def-item><term>RSNA</term><def><p>Radiological Society of North America</p></def></def-item><def-item><term>STL</term><def><p>Standard Tessellation Language</p></def></def-item></def-list></glossary><ack><sec id="FPar1"><title>Funding</title><p>No funding sources to declare for this study.</p></sec><sec id="FPar2"><title>Authors&#x02019; contributions</title><p>AS and LC conceived the design, analyzed the data, drafted, edited and critically revised the manuscript. AG and TH contributed significant portions of the manuscript. AW provided customized illustrations. LC carried out data collection and analysis. AS, AG, AW, CT, SK, EA, DM, LC interpreted the data and drafted the manuscript. All authors have read and have given final approval of the version to be published. All authors read and approved the final manuscript.</p></sec><sec id="FPar3" sec-type="COI-statement"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="FPar4"><title>Consent for publication</title><p>The DICOM patient images used this this publication are obtained from open anonymized online repositories publishing patient data with patient consent. Statements to this effect are available on the respective websites of the OsiriX Image Library [<xref ref-type="bibr" rid="CR17">17</xref>] and the Cancer Imaging Archive [<xref ref-type="bibr" rid="CR16">16</xref>].</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giannopoulos</surname><given-names>AA</given-names></name><name><surname>Leonid</surname><given-names>C</given-names></name><name><surname>Adnan</surname><given-names>S</given-names></name><name><surname>Aili</surname><given-names>W</given-names></name><name><surname>Wilfred</surname><given-names>D</given-names></name><name><surname>Ekin</surname><given-names>A</given-names></name><name><surname>Chris</surname><given-names>H</given-names></name><name><surname>Nicole</surname><given-names>W</given-names></name><name><surname>Todd</surname><given-names>P</given-names></name><name><surname>Dydynski</surname><given-names>PB</given-names></name><name><surname>Rybicki</surname><given-names>DMFJ</given-names></name></person-group><article-title>3D printed ventricular septal defect patch: a primer for the 2015 Radiological Society of North America (RSNA) hands-on course in 3D printing</article-title><source>3D Printing in Medicine</source><year>2015</year><volume>1</volume><fpage>3</fpage><pub-id pub-id-type="doi">10.1186/s41205-015-0002-4</pub-id><pub-id pub-id-type="pmid">30050972</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitsouras</surname><given-names>D</given-names></name><name><surname>Liacouras</surname><given-names>P</given-names></name><name><surname>Imandzadeh</surname><given-names>A</given-names></name><name><surname>Giannopoulos</surname><given-names>A</given-names></name><name><surname>Cai</surname><given-names>T</given-names></name><name><surname>Kumamaru</surname><given-names>K</given-names></name><etal/></person-group><article-title>Medical 3D printing for the radiologist</article-title><source>Radiographics</source><year>2015</year><volume>35</volume><issue>7</issue><fpage>1965</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1148/rg.2015140320</pub-id><pub-id pub-id-type="pmid">26562233</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">United States Food and Drug Administration. Technical Considerations for Additive Manufactured Devices. Draft Guidance for Industry and Food and Drug Administration Staff. <ext-link ext-link-type="uri" xlink:href="http://www.fda.gov/downloads/medicaldevices/deviceregulationandguidance/guidancedocuments/ucm499809.pdf">https://doi.org/www.fda.gov/downloads/medicaldevices/deviceregulationandguidance/guidancedocuments/ucm499809.pdf</ext-link>. Accessed 8 Oct 2016.</mixed-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunkwall</surname><given-names>J</given-names></name><name><surname>Hauksson</surname><given-names>H</given-names></name><name><surname>Bengtsson</surname><given-names>H</given-names></name><etal/></person-group><article-title>Solitary aneurysms of the iliac arterial system: an estimate of their frequency of occurrence</article-title><source>J Vasc Surg</source><year>1989</year><volume>10</volume><fpage>381</fpage><lpage>4</lpage><pub-id pub-id-type="doi">10.1016/0741-5214(89)90411-4</pub-id><pub-id pub-id-type="pmid">2795762</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreira</surname><given-names>J</given-names></name><name><surname>Canedo</surname><given-names>A</given-names></name><name><surname>Brand&#x000e3;o</surname><given-names>D</given-names></name><name><surname>Maia</surname><given-names>M</given-names></name><name><surname>Braga</surname><given-names>S</given-names></name><name><surname>Chaparro</surname><given-names>M</given-names></name><name><surname>Barreto</surname><given-names>P</given-names></name><name><surname>Vaz</surname><given-names>G</given-names></name></person-group><article-title>Isolated iliac artery aneurysms: six-year experience</article-title><source>Interact Cardiovasc Thorac Surg</source><year>2010</year><volume>10</volume><issue>2</issue><fpage>245</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1510/icvts.2009.218305</pub-id><pub-id pub-id-type="pmid">19910361</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Gloviczki</surname><given-names>P</given-names></name><name><surname>Duncan</surname><given-names>AA</given-names></name><name><surname>Kalra</surname><given-names>M</given-names></name><name><surname>Hoskin</surname><given-names>TL</given-names></name><name><surname>Oderich</surname><given-names>GS</given-names></name><name><surname>McKusick</surname><given-names>MA</given-names></name><name><surname>Bower</surname><given-names>TC</given-names></name></person-group><article-title>Common iliac artery aneurysm: expansion rate and results of open surgical and endovascular repair</article-title><source>J Vasc Surg</source><year>2008</year><volume>47</volume><issue>6</issue><fpage>1203</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1016/j.jvs.2008.01.050</pub-id><pub-id pub-id-type="pmid">18514838</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCready</surname><given-names>RA</given-names></name><name><surname>Pairolero</surname><given-names>PC</given-names></name><name><surname>Gilmore</surname><given-names>JC</given-names></name><name><surname>Kazimer</surname><given-names>FJ</given-names></name><name><surname>Cherry</surname><given-names>KJ</given-names><suffix>Jr</suffix></name><name><surname>Hollier</surname><given-names>LH</given-names></name></person-group><article-title>Isolated iliac artery aneurysms</article-title><source>Surgery</source><year>1983</year><volume>93</volume><fpage>688</fpage><lpage>93</lpage><pub-id pub-id-type="pmid">6845175</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santilli</surname><given-names>SM</given-names></name><name><surname>Wernsing</surname><given-names>SE</given-names></name><name><surname>Lee</surname><given-names>ES</given-names></name></person-group><article-title>Expansion rates and outcomes for iliac artery aneurysms</article-title><source>J Vasc Surg</source><year>2000</year><volume>31</volume><fpage>114</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/S0741-5214(00)70073-5</pub-id><pub-id pub-id-type="pmid">10642714</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>NV</given-names></name><name><surname>Long</surname><given-names>GW</given-names></name><name><surname>Cheema</surname><given-names>ZF</given-names></name><name><surname>Rimar</surname><given-names>K</given-names></name><name><surname>Brown</surname><given-names>OW</given-names></name><name><surname>Shanley</surname><given-names>CJ</given-names></name></person-group><article-title>Open vs. endovascular repair of isolated iliac artery aneurysms: A 12-year experience</article-title><source>J Vasc Surg</source><year>2009</year><volume>49</volume><issue>5</issue><fpage>1147</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1016/j.jvs.2008.11.101</pub-id><pub-id pub-id-type="pmid">19237261</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albertini</surname><given-names>JN</given-names></name><name><surname>Favre</surname><given-names>JP</given-names></name><name><surname>Bouziane</surname><given-names>Z</given-names></name><name><surname>Haase</surname><given-names>C</given-names></name><name><surname>Nourrissat</surname><given-names>G</given-names></name><name><surname>Barral</surname><given-names>X</given-names></name></person-group><article-title>Aneurysmal extension to the iliac bifurcation increases the risk of complications and secondary procedures after endovascular repair of abdominal aortic aneurysms</article-title><source>Ann Vasc Surg</source><year>2010</year><volume>24</volume><issue>5</issue><fpage>663</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.avsg.2010.01.008</pub-id><pub-id pub-id-type="pmid">20413255</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nascimento</surname><given-names>AF</given-names></name><name><surname>Raut</surname><given-names>CP</given-names></name></person-group><article-title>Diagnosis and management of pleomorphic sarcomas (so-called &#x0201c;MFH&#x0201d;) in adults</article-title><source>J Surg Oncol</source><year>2008</year><volume>97</volume><issue>4</issue><fpage>330</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1002/jso.20972</pub-id><pub-id pub-id-type="pmid">18286476</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matushansky</surname><given-names>I</given-names></name><name><surname>Charytonowicz</surname><given-names>E</given-names></name><name><surname>Mills</surname><given-names>J</given-names></name><name><surname>Siddiqi</surname><given-names>S</given-names></name><name><surname>Hricik</surname><given-names>T</given-names></name><name><surname>Cordon-Cardo</surname><given-names>C</given-names></name></person-group><article-title>MFH classification: differentiating undifferentiated pleomorphic sarcoma in the 21st Century</article-title><source>Expert Rev Anticancer Ther</source><year>2009</year><volume>9</volume><issue>8</issue><fpage>1135</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1586/era.09.76</pub-id><pub-id pub-id-type="pmid">19671033</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Doussal</surname><given-names>V</given-names></name><name><surname>Coindre</surname><given-names>JM</given-names></name><name><surname>Leroux</surname><given-names>A</given-names></name><name><surname>Hacene</surname><given-names>K</given-names></name><name><surname>Terrier</surname><given-names>P</given-names></name><name><surname>Bui</surname><given-names>NB</given-names></name><name><surname>Bonichon</surname><given-names>F</given-names></name><name><surname>Collin</surname><given-names>F</given-names></name><name><surname>Mandard</surname><given-names>AM</given-names></name><name><surname>Contesso</surname><given-names>G</given-names></name></person-group><article-title>Prognostic factors for patients with localized primary malignant fibrous histiocytoma: a multicenter study of 216 patients with multivariate analysis</article-title><source>Cancer</source><year>1996</year><volume>77</volume><issue>9</issue><fpage>1823</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0142(19960501)77:9&#x0003c;1823::AID-CNCR10&#x0003e;3.0.CO;2-1</pub-id><pub-id pub-id-type="pmid">8646680</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salo</surname><given-names>JC</given-names></name><name><surname>Lewis</surname><given-names>JJ</given-names></name><name><surname>Woodruff</surname><given-names>JM</given-names></name><name><surname>Leung</surname><given-names>DH</given-names></name><name><surname>Brennan</surname><given-names>MF</given-names></name></person-group><article-title>Malignant fibrous histiocytoma of the extremity</article-title><source>Cancer</source><year>1999</year><volume>85</volume><issue>8</issue><fpage>1765</fpage><lpage>1772</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0142(19990415)85:8&#x0003c;1765::AID-CNCR17&#x0003e;3.0.CO;2-K</pub-id><pub-id pub-id-type="pmid">10223571</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zagars</surname><given-names>GK</given-names></name><name><surname>Mullen</surname><given-names>JR</given-names></name><name><surname>Pollack</surname><given-names>A</given-names></name></person-group><article-title>Malignant fibrous histiocytoma: outcome and prognostic factors following conservation surgery and radiotherapy</article-title><source>Int J Radiat Oncol Biol Phys</source><year>1996</year><volume>34</volume><issue>5</issue><fpage>983</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1016/0360-3016(95)02262-7</pub-id><pub-id pub-id-type="pmid">8600111</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>K</given-names></name><name><surname>Vendt</surname><given-names>B</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Freymann</surname><given-names>J</given-names></name><name><surname>Kirby</surname><given-names>J</given-names></name><name><surname>Koppel</surname><given-names>P</given-names></name><name><surname>Moore</surname><given-names>S</given-names></name><name><surname>Phillips</surname><given-names>S</given-names></name><name><surname>Maffitt</surname><given-names>D</given-names></name><name><surname>Pringle</surname><given-names>M</given-names></name><name><surname>Tarbox</surname><given-names>L</given-names></name><name><surname>Prior</surname><given-names>F</given-names></name></person-group><article-title>The Cancer Imaging Archive (TCIA): maintaining and operating a public information repository</article-title><source>J Digit Imaging</source><year>2013</year><volume>26</volume><issue>6</issue><fpage>1045</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1007/s10278-013-9622-7</pub-id><pub-id pub-id-type="pmid">23884657</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">OsiriX DICOM Image Library. <ext-link ext-link-type="uri" xlink:href="http://www.osirix-viewer.com/datasets/DATA/MACOESSIX.zip">https://doi.org/www.osirix-viewer.com/datasets/DATA/MACOESSIX.zip</ext-link>. Accessed 8 Oct 2016.</mixed-citation></ref></ref-list></back></article>