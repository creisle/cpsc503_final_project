<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="brief-report"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">3D Print Med</journal-id><journal-id journal-id-type="iso-abbrev">3D Print Med</journal-id><journal-title-group><journal-title>3D Printing in Medicine</journal-title></journal-title-group><issn pub-type="epub">2365-6271</issn><publisher><publisher-name>Springer International Publishing</publisher-name><publisher-loc>Cham</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">29782619</article-id><article-id pub-id-type="pmc">5954793</article-id><article-id pub-id-type="publisher-id">22</article-id><article-id pub-id-type="doi">10.1186/s41205-017-0022-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Technical Note</subject></subj-group></article-categories><title-group><article-title>Preoperative planning and tracheal stent design in thoracic surgery: a primer for the 2017 Radiological Society of North America (RSNA) hands-on course in 3D printing</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7010-3812</contrib-id><name><surname>Chepelev</surname><given-names>Leonid</given-names></name><address><email>leonid.chepelev@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Souza</surname><given-names>Carolina</given-names></name><address><email>csouza@toh.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Althobaity</surname><given-names>Waleed</given-names></name><address><email>walthobaity@toh.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Miguel</surname><given-names>Olivier</given-names></name><address><email>omigu094@uottawa.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Krishna</surname><given-names>Satheesh</given-names></name><address><email>dr.satheeshkrishna@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Akyuz</surname><given-names>Ekin</given-names></name><address><email>ekinakyuz@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hodgdon</surname><given-names>Taryn</given-names></name><address><email>tahodgdon@toh.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Torres</surname><given-names>Carlos</given-names></name><address><email>catorres@toh.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wake</surname><given-names>Nicole</given-names></name><address><email>nicole.wake@med.nyu.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Alexander</surname><given-names>Amy</given-names></name><address><email>Alexander.Amy@mayo.edu</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>George</surname><given-names>Elizabeth</given-names></name><address><email>EGEORGE6@partners.org</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Anji</given-names></name><address><email>Anji_Tang@hms.harvard.edu</email></address><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Liacouras</surname><given-names>Peter</given-names></name><address><email>peter.c.liacouras.civ@mail.mil</email></address><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Matsumoto</surname><given-names>Jane</given-names></name><address><email>matsumoto.jane@mayo.edu</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Morris</surname><given-names>Jonathan</given-names></name><address><email>Morris.Jonathan@mayo.edu</email></address><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Christensen</surname><given-names>Andy</given-names></name><address><email>biomdlr@me.com</email></address><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Mitsouras</surname><given-names>Dimitrios</given-names></name><address><email>D.Mitsouras@uottawa.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Rybicki</surname><given-names>Frank</given-names></name><address><email>frybicki@toh.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Sheikh</surname><given-names>Adnan</given-names></name><address><email>asheikh@toh.ca</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2182 2255</institution-id><institution-id institution-id-type="GRID">grid.28046.38</institution-id><institution>Department of Medical Imaging, The Ottawa Hospital, </institution><institution>University of Ottawa School of Medicine, </institution></institution-wrap>Ottawa, ON Canada </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8753</institution-id><institution-id institution-id-type="GRID">grid.137628.9</institution-id><institution>Department of Radiology, </institution><institution>New York University, </institution></institution-wrap>New York, NY USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0459 167X</institution-id><institution-id institution-id-type="GRID">grid.66875.3a</institution-id><institution>Department of Radiology, </institution><institution>Mayo Clinic, </institution></institution-wrap>Rochester, MN USA </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0378 8294</institution-id><institution-id institution-id-type="GRID">grid.62560.37</institution-id><institution>Department of Radiology, </institution><institution>Brigham and Women&#x02019;s Hospital, </institution></institution-wrap>Boston, MA USA </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0560 6544</institution-id><institution-id institution-id-type="GRID">grid.414467.4</institution-id><institution>Department of Radiology, </institution><institution>Walter Reed National Military Medical Center, </institution></institution-wrap>Bethesda, MD USA </aff><aff id="Aff6"><label>6</label>SOMADEN LLC, Littleton, CO USA </aff></contrib-group><pub-date pub-type="epub"><day>6</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>6</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="collection"><month>3</month><year>2017</year></pub-date><volume>3</volume><elocation-id>14</elocation-id><history><date date-type="received"><day>16</day><month>11</month><year>2017</year></date><date date-type="accepted"><day>22</day><month>11</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">In this work, we provide specific clinical examples to demonstrate basic practical techniques involved in image segmentation, computer-aided design, and 3D printing. A step-by-step approach using United States Food and Drug Administration cleared software is provided to enhance surgical intervention in a patient with a complex superior sulcus tumor. Furthermore, patient-specific device creation is demonstrated using dedicated computer-aided design software. Relevant anatomy for these tasks is obtained from CT Digital Imaging and Communications in Medicine images, leading to the generation of 3D printable files and delivery of these files to a 3D printer.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s41205-017-0022-3) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>3D printing</kwd><kwd>Pancoast tumor</kwd><kwd>Tracheal Stenosis</kwd><kwd>Cancer</kwd><kwd>Segmentation</kwd><kwd>Computer-aided design</kwd><kwd>Thoracic surgery</kwd><kwd>Implant</kwd><kwd>Radiological Society of North America</kwd><kwd>Precision medicine</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2017</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><sec id="Sec2"><title>General overview</title><p id="Par12">This is the third publication in an educational series presented by our group for hands-on 3D printing teaching at the annual meeting of the Radiological Society of North America (RSNA) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The overall 3D printing workflow and the involved software and hardware technologies (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>) have been reviewed at length [<xref ref-type="bibr" rid="CR3">3</xref>]. In basic terms, clinical 3D printing begins with the acquisition of cross-sectional images. Among cross-sectional techniques, Computed Tomography (CT) is the most common volumetric imaging modality [<xref ref-type="bibr" rid="CR4">4</xref>]. The ubiquity, high signal-to-noise ratio, contrast enhancement options, and spatial resolution account for the popularity of this modality in 3D printing. It is preferable to segment images acquired with isotropic voxels, with side length on the order of 1&#x000a0;mm. Intravenous contrast should be timed to optimize visualization of the relevant pathology and anatomy.<fig id="Fig1"><label>Fig. 1</label><caption><p>General 3D Printing process overview, adapted from Mitsouras et al. [<xref ref-type="bibr" rid="CR3">3</xref>]</p></caption><graphic xlink:href="41205_2017_22_Fig1_HTML" id="MO1"/></fig>
</p><p id="Par13">Segmentation can be regarded as the process of separation of the relevant anatomy to be included within the 3D printed model. From a technical perspective, segmentation defines the criteria for the voxels to be included in the 3D printed model. For example, such criteria may include connectivity to a seed point in the volumetric data selected by a user. Another example involves the selection of all the voxels with a corresponding density value within a specified range of Hounsfield Units (HU) for Computed Tomography (CT) data or intensity values for Magnetic Resonance Imaging (MRI) data depending on the specific application and suitability of the imaging modality for the demonstration of the pathology in question. In yet another example, all the voxels within a specific manually defined geometric bounding box may be selected. The sequential application of and combinations of such selection criteria using manual or semi-automated techniques may be employed in segmentation, resulting in the selection of the desired anatomy.</p><p id="Par14">The process of 3D visualization &#x02013; defined as the collection of methods and technologies used to visualize the 3D representation of cross-sectional data volumes on two-dimensional computer screens - typically ends at isolating and displaying a set of segmented voxels from Digital Imaging and Communications in Medicine (DICOM) images. Additional manipulations are required to enable 3D printing. Specifically, the collection of voxels representing a desired anatomy needs to be transformed into a printable&#x000a0;3D object via a process referred to as tessellation.</p><p id="Par15">Tessellation is widely used in computer graphics to approximate shapes using a set of triangles. The more triangles used in tessellation, the more refined a shape becomes. Unfortunately, the transformation of a segmented Region of Interest into a 3D object using tessellation does not ensure model printability or stability. For instance, it may be necessary for the model to be further smoothed, non-printable parts may be removed or mathematically adjusted, and vulnerable areas may be reinforced using a range of manual manipulations and automated algorithms to ensure models that are robust and to minimize printing failure rates. The result of these operations is stored as an alternative file type, usually a Standard Tessellation Language/Stereolithrography (STL) file submitted to, and recognized by, a 3D printer to build the model.</p><p id="Par16">Once an accurate representation of the relevant patient anatomy is obtained in the form of a printable&#x000a0;3D model, further manipulations using Computer-Aided Design (CAD) software is typically necessary for model refinement or patient-specific instrument design.</p></sec><sec id="Sec3"><title>Software overview</title><p id="Par17">To illustrate the most common techniques in using segmentation and post-processing software, this work uses Materialise Mimics inPrint and 3-matic (Materialise, Leuven, Belgium). Although numerous software packages are available to carry out these tasks, the software presented in this work is US FDA-cleared for the medical applications demonstrated in this work. Mimics inPrint software facilitates the processing of 2D image data acquired from axial imaging (CT, MRI) to create 3D printable models. While a significant portion of Materialise Mimics functionality is present in this package, certain higher-order operations, including various segmentation algorithms present in more advanced packages such as Materialise Mimics, are omitted in this paper for simplicity.</p><p id="Par18">Materialise 3-matic Medical software contains a set of CAD tools useful in the design of medically relevant models. This software enables the manipulation of patient-derived 3D models as well as creation and design of entirely new models in the context of patient anatomy. The application of this package in anatomical reconstruction and medical device creation will be explored in this work.</p><p id="Par19">We also discuss the use of build preparation software, namely GrabCAD (Stratasys Ltd., MN, USA). While the build preparation is highly variable, and is usually bundled with the specific printer used, the GrabCAD Print software and services demonstrate the typical features of such software in a single package. GrabCAD is an online 3D printed model preparation, management, and monitoring service and software. GrabCAD enables the preparation of 3D models for printing and enables the exploration of factors such as part placement, material costs, build times, and material selection to optimize the 3D printing process. The built-in adaptable software interface allows the preparation of prints using complex multi-material PolyJet technology and simpler FDM-based printers alike.</p></sec><sec id="Sec4"><title>Clinical overview</title><p id="Par20">Superior sulcus (Pancoast) tumors frequently involve the pleura, bones, vessels, and nerves, and therefore present challenging management decisions that can be aided by 3D printing [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Specifically, the choice of whether to pursue surgical management can be swayed by a physical, 3D printed model. Depending on the extent of disease, and following neoadjuvant radiotherapy, surgical management may involve minimally invasive surgery and is often quite delicate, requiring excellent visualization and understanding of the involved anatomy to optimize patient outcomes. Reconstruction of the chest wall is typically not performed in the cases that involve only the first three ribs or where the chest wall defect is entirely covered by the scapula. Cases outside of this domain are typically repaired using a Gore-Tex patch. While cases involving vertebral reconstruction and spinal fusion have been demonstrated, such cases are relatively rare. In cases where neoplastic involvement results in sufficient mass effect to induce significant tracheal or bronchial stenosis, stents may be considered to improve patient quality of life. The purpose of this work is to explore the basic approaches that may be used in complex neoplastic pathology model creation and patient-specific tracheal stent design used in medical 3D printing. This will be accomplished starting with arterial-phase axial CT images using 1&#x000a0;mm reconstruction in soft tissue windows. The readers will be exposed to a broad range of basic approaches that may be used in creating a complex neoplastic pathology model and the digital design process of creating a tracheal stent for 3D printing.</p></sec></sec><sec id="Sec5"><title>Segmentation</title><p id="Par21">Segmentation separates the voxels of interest using a range of properties, such as their HU values, presence within a specific predefined bounding box ranging from the entire study volume to a limited region of interest, or a degree of contiguity to define a single continuous structure such as a rib or a vessel. The files included with this work in supporting documentation can be opened by double-clicking after the installation of the inPrint software, or from within the inPrint software using the File menu on systems where this software is installed. The main program window contains the toolbox on the left as well as project visualization with the three orthogonal visualization planes and the 3D rendering window (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). DICOM images may be imported and loaded into a project file, using a similar intuitive wizard from the File menu as well. Before progressing further, please take a moment to familiarize yourself with the software shortcuts and anatomy (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Layout of the inPrint software graphical user interface. On the top left, the menu toolbar with File, Edit, View, and Help menus. Below this, menu toolbar with segmentation and model editing menus. The operation toolbar (titled Guided Segmentation on this view) contains the available operations and operation settings. Below this, the ROI and Part lists can be found. Top right, the three orthogonal planes and the 3D visualizations are shown. Finally, the lower right is reserved for software logs and various HU distribution and window/level visualizations</p></caption><graphic xlink:href="41205_2017_22_Fig2_HTML" id="MO2"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Selected software shortcuts in the in Print software</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Shortcut</th><th>Action</th></tr></thead><tbody><tr><td>Scroll wheel (center mouse)<break/>OR Shift right click + drag</td><td>Pan: Move the mouse while keeping the center click pressed</td></tr><tr><td>Right click + drag (2D Views)</td><td>Zoom: Move the mouse vertically while keeping the button pressed</td></tr><tr><td>CTRL + right click + drag (3D View)</td><td>Zoom: Move the mouse vertically while keeping the buttons pressed</td></tr><tr><td>Arrow Up/Scroll wheel up</td><td>Go to next slice</td></tr><tr><td>Arrow Down/Scroll wheel down</td><td>Go to previous slice</td></tr><tr><td>Page Up</td><td>Skip 10 slices upward</td></tr><tr><td>Page Down</td><td>Skip 10 slices downward</td></tr><tr><td>CTRL + L</td><td>Make slice indicators visible/invisible</td></tr><tr><td>SPACE</td><td>Zoom the chosen view to full screen and back</td></tr><tr><td>Backspace</td><td>Switch between two window states</td></tr><tr><td>CTRL + Z</td><td>Undo the previous action.</td></tr><tr><td>CTRL + Right click + Drag (2D Views)</td><td>Adjusts window/level in 2D images</td></tr></tbody></table></table-wrap>
</p><sec id="Sec6"><title>Segmentation of bones</title><p id="Par22">We begin this segmentation step by identifying the thoracic skeletal structures. To do this, we will use Thresholding tool from the Create ROI menu and select the Bone (CT) preset to identify a Hounsfield Unit (HU) range that typically corresponds to bones in a typical CT scan. Since this range is not satisfactory in these particular images due to the reconstruction algorithms and acquisition parameters used, we shall adjust the lower HU bounds to 100 by typing this number in the appropriate field (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Setting up the segmentation for osseous structures</p></caption><graphic xlink:href="41205_2017_22_Fig3_HTML" id="MO3"/></fig>
</p><p id="Par23">We will also adjust the bounding box to exclude the CT table from the ROI by left-clicking and dragging these boundaries, as demonstrated. Since we do not need the lower and the contralateral upper thorax, or the neck, we will adjust the superior and inferior boundaries to solely focus on the tumor, including the acromioclavicular junction and a portion of the shoulder (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p><p id="Par24">Given this range of HU values, you will notice that the voxels of interest are now highlighted, and are a part of a single preliminary ROI visualized on the 3D view. Although the ROI we are creating occupies a 3D space, and is composed of thousands of individual voxels, it cannot be directly submitted for 3D printing, as it needs to be converted to a three-dimensional model readable by a 3D printer, such as an STL model. As stated earlier, in an STL model, all geometric shapes are redefined as a collection of surface triangles that approximate the shape of the object in question through a process known as &#x0201c;tessellation&#x0201d;. In general, the more triangles are used, the higher is the fidelity of the representation, which could result in greater computational demand for manipulating the object.</p><p id="Par25">To summarize, for the purposes of this discussion, the ROI is a collection of cubic or cuboid voxels different from a 3D printable model. The ROI will be converted to printable file after we ensure that the appropriate voxels are included within the ROI first.</p><p id="Par26">Notice that a number of structures have been included within the current preliminary ROI, including the heart and the major vasculature, as well as the leads on the patient&#x02019;s anterior chest wall. Many of these undesirable voxels will be removed in the later stages of the segmentation. Select the option to &#x02018;Keep Largest Region&#x02019; to leave only the contiguous voxels within the newly generated ROI and press the green checkmark. After this step is complete, you will note that the ECG leads from the patient&#x02019;s anterior chest wall and any non-contiguous voxels selected in the previous step have been removed because they were not attached to the largest contiguous voxel ROI (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><p>Result of the segmentation operation with HU, contiguity, and bounding box restrictions</p></caption><graphic xlink:href="41205_2017_22_Fig4_HTML" id="MO4"/></fig>
</p><p id="Par27">You will also notice that the new ROI, titled &#x02018;Bone (CT)&#x02019; has appeared in the list of ROIs, and the menu has changed to the Edit ROI menu, which allows separation of unwanted portions of the ROI and combination of different ROIs together using the &#x02018;Split&#x02019; tool. We shall take advantage of this tool to remove the great vessels and the included potion of the heart, while leaving the bones in place.</p><p id="Par28">To do this, we define the &#x02018;Background&#x02019; and the &#x02018;Foreground&#x02019; structures on several views using the appropriate brushes within the split tool. We will use the axial view and, clicking the appropriate Background/Foreground buttons, we will outline all bony structures to be included in the Foreground, and everything else as Background on images marked as 167, 213, 287, and 292 as indicated in the lower left corner in the axial view images (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). When this is complete, select &#x02018;Create result in new ROI&#x02019; option and name it &#x02018;Bones Only&#x02019;. Press the green checkmark to complete the operation. Now and henceforth, when an operation is set up as indicated, the green checkmark is used in the inPrint software to accept the parameters and execute the operation.<fig id="Fig5"><label>Fig. 5</label><caption><p>Setting up the splitting tool and marking up the appropriate osseous anatomy as the foreground (blue) and vascular anatomy as background (black). Note image&#x000a0;292 is not shown</p></caption><graphic xlink:href="41205_2017_22_Fig5_HTML" id="MO5"/></fig>
</p><p id="Par29">The resultant osseous structures are well-separated and contain only few residual vessels that can be removed manually (Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>Results of the Split tool, separating the majority of the osseous structures from the vasculature</p></caption><graphic xlink:href="41205_2017_22_Fig6_HTML" id="MO6"/></fig>
</p><p id="Par30">To touch up the ROI manually, we will select the Brush tool from the &#x02018;Edit ROI&#x02019; menu, then the &#x02018;Erase&#x02019; brush and on axial images, we will delete the vessel running adjacent to the scapula by editing the ROI on axial images, painting with the &#x02018;Erase&#x02019; brush by left-clicking and dragging on the undesired voxels on each relevant axial image (Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>).<fig id="Fig7"><label>Fig. 7</label><caption><p>Using the Brush tool to erase unwanted portions of the ROI, slice-by-slice</p></caption><graphic xlink:href="41205_2017_22_Fig7_HTML" id="MO7"/></fig>
</p><p id="Par31">After you are satisfied with your edits, go back to the &#x02018;Edit ROI&#x02019; menu and select the &#x02018;Isolate&#x02019; tool. This tool allows you to isolate a collection of all contiguous voxels into a single ROI and isolate it from all the non-contiguous, floating parts, which are typically undesirable for the final model. Left-click anywhere on the desired portion of the ROI to see it highlighted green, while the non-connected voxels will remain in their original color (Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><p>Split tool in action &#x02013; left clicking on the desired contiguous portion of the anatomy isolates it (green) from the non-contiguous fragments (yellow)</p></caption><graphic xlink:href="41205_2017_22_Fig8_HTML" id="MO8"/></fig>
</p><p id="Par32">Note that you can rename the ROIs at any time by single-clicking their names and typing the new name, then pressing &#x02018;Enter&#x02019; on the keyboard. Model color can be adjusted to any appealing value from a palette by left-clicking the color square to the left of ROI name (Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>). You can also hide and show a specific ROI by clicking on the eye button next to the ROI name.<fig id="Fig9"><label>Fig. 9</label><caption><p>Renaming, showing/hiding, and recoloring ROIs</p></caption><graphic xlink:href="41205_2017_22_Fig9_HTML" id="MO9"/></fig>
</p></sec><sec id="Sec7"><title>Segmentation of vascular anatomy</title><p id="Par33">While the same process as the one used for the bones can be repeated to segment the major vascular structures, we will use the Subtraction tool from the &#x02018;Edit ROI&#x02019; menu since we already have a high-quality ROI that includes bony anatomy that can be subtracted from the ROI that contains the bone and vascular anatomy.</p><p id="Par34">To do this, select the &#x02018;Subtract&#x02019; tool from the &#x02018;Edit ROI&#x02019; menu. Click on the &#x02018;Selection&#x02019; box (here and elsewhere, &#x02018;click&#x02019; refers to left-clicking) and then click on the Bone (CT) ROI from the ROI list (Figure). For the ROI to subtract, select the &#x02018;Bones Only&#x02019; ROI by the same method (Figure). If you select the wrong ROI, simply click its name on the &#x02018;Selection&#x02019; or &#x02018;ROI to subtract&#x02019; box and press the &#x02018;Delete&#x02019; key on your keyboard, and try again. Select the &#x02018;Create result in new ROI&#x02019; option and name it &#x02018;Vasculature&#x02019; as shown (Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>). After clicking the green checkbox, this operation will complete and result in vascular anatomy, with inclusion of the thyroid gland, which can be removed later, should this be desired.<fig id="Fig10"><label>Fig. 10</label><caption><p>Setting up ROI subtraction</p></caption><graphic xlink:href="41205_2017_22_Fig10_HTML" id="MO10"/></fig>
</p><p id="Par35">Notice that portions of soft tissue included in the tumor are present in this model. Use the Subtract tool again to remove the tumor ROI included with the project from the vasculature, using the methodology above. Clean the model up using a combination of the Brush and Isolate tools as discussed earlier (Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref>).<fig id="Fig11"><label>Fig. 11</label><caption><p>Second application of the ROI subtraction tool.</p></caption><graphic xlink:href="41205_2017_22_Fig11_HTML" id="MO11"/></fig>
</p><p id="Par36">Notice that while the arterial anatomy is well-characterized, the veins &#x02013; a possible significant source of intraoperative hemorrhage &#x02013; have not been well characterized on this arterial phase study. It may be necessary to either manually reconstruct the venous anatomy using these DICOM images (a time-consuming manual approach using the brush tool on every relevant 2D image), or fuse the available arterial phase ROIs with those obtained from images acquired using a different phase of contrast opacification.</p></sec><sec id="Sec8"><title>Segmentation of lungs and major airways</title><p id="Par37">In order to segment the lungs and major airways, we will repeat the segmentation from the &#x02018;Create ROI&#x02019; menu, use the Thresholding tool and select the &#x02018;Airways (CT)&#x02019; preset. Adjust the bounding box to only include the portion of the lungs and airways of interest and select the &#x02018;Keep Largest Region&#x02019; option. Select the upper bound of the thresholding operation to be &#x02212;200 HU before creating the ROI (Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>).<fig id="Fig12"><label>Fig. 12</label><caption><p>Segmenting the airways using the Airways (CT) preset</p></caption><graphic xlink:href="41205_2017_22_Fig12_HTML" id="MO12"/></fig>
</p><p id="Par38">The result is an ROI that includes air within the lungs and trachea. To better define the intraluminal tracheal configuration, the Thresholding tool can be used again, with &#x02212;1024 to &#x02212;931 HU range. Adjust the bounding box to center it on the trachea, and proceed to generate the tracheal ROI by clicking the green checkmark, as indicated (Fig.&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref>).<fig id="Fig13"><label>Fig. 13</label><caption><p>Segmentation of the trachea. Note the HU range and the narrow bounding box adjustments</p></caption><graphic xlink:href="41205_2017_22_Fig13_HTML" id="MO13"/></fig>
</p></sec><sec id="Sec9"><title>Tumor segmentation</title><p id="Par39">For ease of use, we have included a pre-segmented tumor ROI with the dataset provided. The task of segmenting this ROI from the surrounding soft tissues is time consuming, and the tumor is often difficult to distinguish from the adjacent soft tissues of the chest wall, especially on images obtained from phases where the tumor does not exhibit significant enhancement. The differential enhancement of the tumor in this case is not amenable for semi-automated isolation, necessitating the use of additional intravenous contrast phases, or fusion with other imaging such as MRI or PET where the tumor extent may be more accurately demonstrated, per the discretion of the radiologist and the clinical team. If you wish to segment this tumor manually, you may experiment with thresholding tools to select the soft tissue HU range best depicting the tumor alone to define a starting ROI within the left upper thorax, followed by image-by-image manual edits to segment the tumor.</p><p id="Par40">At this time, we have segmented the tumor, vessels, airways, lungs, and bones and are ready for the next step (Fig.&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref>). Use the &#x02018;Solid Part&#x02019; tool from the &#x02018;Create Part&#x02019; menu to create 3D models, or parts, for each of the relevant ROI entities to enable further manipulation in CAD software or direct 3D printing (Figs.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref>, <xref rid="Fig16" ref-type="fig">16</xref>). This constitutes the transition from an ROI composed only of rectangular voxels to 3D models. You will notice some step artifact in the resultant models, relating to the acquisition technique for the original images, not optimized for 3D printing &#x02013; namely, not highest resolution possible isotropic reconstructions.<fig id="Fig14"><label>Fig. 14</label><caption><p>Results of the segmentation</p></caption><graphic xlink:href="41205_2017_22_Fig14_HTML" id="MO14"/></fig>
<fig id="Fig15"><label>Fig. 15</label><caption><p>Selection of the Solid Part function from the &#x02018;Create Part&#x02019; menu (highlighted)</p></caption><graphic xlink:href="41205_2017_22_Fig15_HTML" id="MO15"/></fig>
<fig id="Fig16"><label>Fig. 16</label><caption><p>Selection of the ROIs to convert to 3D models</p></caption><graphic xlink:href="41205_2017_22_Fig16_HTML" id="MO16"/></fig>
</p></sec><sec id="Sec10"><title>Model export</title><p id="Par41">After model generation is complete, export the models to STL files using the &#x02018;Export&#x02019; tool from the &#x02018;Prepare Print&#x02019; menu (Fig.&#x000a0;<xref rid="Fig17" ref-type="fig">17</xref>). Add all the parts from the Parts list by left-clicking them, select the Monocolor (.STL) output, and choose the appropriate export directory using the &#x02018;&#x02026;&#x02019; button. You may scale the exported models if you so wish by using a scaling factor, as demonstrated. The scaling factor requires verification every time the model is exported, as inappropriately set scaling factor may result in wasted prints.<fig id="Fig17"><label>Fig. 17</label><caption><p>Setup of the Export operation</p></caption><graphic xlink:href="41205_2017_22_Fig17_HTML" id="MO17"/></fig>
</p></sec></sec><sec id="Sec11"><title>Creating printable models</title><p id="Par42">In this part, we demonstrate the techniques involved in the generation of hollow and solid printable models using the 3-Matic CAD software. To begin, review the anatomy of the software (Fig.&#x000a0;<xref rid="Fig18" ref-type="fig">18</xref>).<fig id="Fig18"><label>Fig. 18</label><caption><p>Graphical user interface of the 3-matic software. Top left, the menu and tabbed menu toolbars. Center, work area with the visualization of the current model. Right upper corner, the Object Tree with all the involved objects. Right lower corner, the Operations tab, with all operation parameters. Bottom left, the Logger which logs the current actions. Note the Expert Mode at the bottom of the window. This expert mode allows control of additional parameters, some of which are used in this work</p></caption><graphic xlink:href="41205_2017_22_Fig18_HTML" id="MO18"/></fig>
</p><p id="Par43">The basic 3D object manipulation shortcuts and controls are similar to those used in the inPrint 3D view. A set of STL files is included to carry out 3-matic manipulations, without having to create these models through the steps above. Import these STL files using the File &#x0003e; Import Part&#x02026; menu to begin. The resultant models will appear in the Work Area. Model colors may vary, but may be adjusted through the Properties tab, Front Face color setting.</p><sec id="Sec12"><title>Creating hollow airway models</title><p id="Par44">You will notice that while the trachea and vessels are hollow structures, they are represented as solid, corresponding to the air and contrast filling them, respectively. To rectify this, we will use the Wrap tool to smooth and correct these models, followed by the Hollow tool on each of these models to simulate the tracheal and vessel walls, respectively. While the Wrap tool corrects and applies smoothing to the model to create a watertight, printable object, the Hollow tool creates hollow objects based on solid objects by creating a wall on the outside, inside, or both aspects of the outer surface of the solid object. In this case, we will create a 3&#x000a0;mm-thick outside wall for each of these structures. Selection of the wall thickness may be either arbitrary, aesthetic, or guided by material and practical considerations, and in this case is arbitrary, for demonstration purposes.</p><p id="Par45">To do this, right-click every object that is currently not needed in the Object Tree and in the menu that appears, select the &#x02018;Hide&#x02019; option. This will clear the scene and help visualize the edited model better. Starting with the trachea, left-click this object in the Object Tree and then select the &#x02018;Wrap&#x02019; operation from the &#x02018;Fix&#x02019; menu. In the Operations tab, set the gap closing distance to 3&#x000a0;mm and the smallest detail to 0.5&#x000a0;mm (Fig.&#x000a0;<xref rid="Fig19" ref-type="fig">19</xref>).<fig id="Fig19"><label>Fig. 19</label><caption><p>Setting up the Wrap operation for the trachea.</p></caption><graphic xlink:href="41205_2017_22_Fig19_HTML" id="MO19"/></fig>
</p><p id="Par46">This will eliminate all gaps within this structure introduced by artifact such as beam hardening and high image noise. Moving forward, when the operation parameters are set up, use the &#x02018;Apply&#x02019; button to execute it. The resultant model, titled &#x02018;Trachea_wrapped&#x02019; appears on the Object Tree. You will notice a significant overlap with the existing model, with many of the imperfections of the previously created model smoothed as part of this operation (Fig.&#x000a0;<xref rid="Fig20" ref-type="fig">20</xref>). Note that it is possible to create a model that is too highly wrapped or smoothed to reflect anatomy adequately, and verification of the final model in the context of the original DICOM images is required to ensure accuracy. Hide the original trachea model (right click it on the Object Tree and select &#x02018;Hide&#x02019;).<fig id="Fig20"><label>Fig. 20</label><caption><p>The smoothed and wrapped tracheal model (blue) overlapped with the original model (grey)</p></caption><graphic xlink:href="41205_2017_22_Fig20_HTML" id="MO20"/></fig>
</p><p id="Par47">Now, use the smoothing tool through Fix &#x0003e; Smooth in order to apply smoothing to the trachea using the parameters specified, including the advanced parameters highlighted in yellow (Fig.&#x000a0;<xref rid="Fig21" ref-type="fig">21</xref>).<fig id="Fig21"><label>Fig. 21</label><caption><p>Setup of the smoothing operation. Note the yellow settings, which are the advanced settings that can be turned on or off using the Expert Mode toggle at the bottom of the window</p></caption><graphic xlink:href="41205_2017_22_Fig21_HTML" id="MO21"/></fig>
</p><p id="Par48">Since the trachea is a hollow structure with its wall on the <italic>outside</italic> of the intraluminal air segmented earlier, we will use the &#x02018;Hollow&#x02019; tool from the Design &#x0003e; Hollow menu as specified to generate a hollow structure with a 3&#x000a0;mm outside wall (Fig.&#x000a0;<xref rid="Fig22" ref-type="fig">22</xref>).<fig id="Fig22"><label>Fig. 22</label><caption><p>Setting up the hollow operation</p></caption><graphic xlink:href="41205_2017_22_Fig22_HTML" id="MO22"/></fig>
</p><p id="Par49">You will notice that the Hollow operation has resulted in a hollow structure with no external opening. In order to simulate the airway, we will cut off the top of this hollow structure using the Finish &#x0003e; Trim tool. First, position the trachea on the frontal view. To do this, right-click anywhere in the Work Area and select View &#x0003e; Front. Then, using the Finish &#x0003e; Trim tool, ensure that the operation is set up as indicated and the Trachea_wrapped model is in the Entities List. Draw a triangle or any other shape that transects the upper portion of the trachea, as demonstrated by left-clicking at the indicated locations and closing the shape at the end by clicking the starting point again a single time (Fig.&#x000a0;<xref rid="Fig23" ref-type="fig">23</xref>).<fig id="Fig23"><label>Fig. 23</label><caption><p>Setting up the Trim operation</p></caption><graphic xlink:href="41205_2017_22_Fig23_HTML" id="MO23"/></fig>
</p><p id="Par50">The result of this operation is a hollow model of the trachea (Fig.&#x000a0;<xref rid="Fig24" ref-type="fig">24</xref>). The same operations can be reproduced to create hollow models of any structure, including the vasculature and the alimentary tract, among others.<fig id="Fig24"><label>Fig. 24</label><caption><p>Hollow model of the trachea.</p></caption><graphic xlink:href="41205_2017_22_Fig24_HTML" id="MO24"/></fig>
</p></sec><sec id="Sec13"><title>Preparing solid bone and lung models</title><p id="Par51">The smoothing and wrapping tools can be applied to the remaining models, using the Wrapping tool with a lower gap closing distance of 1.5&#x000a0;mm (chosen to balance computational time and quality), followed by the Smoothing tool as indicated previously. The result is a significantly smoother geometry that is easier to 3D print and post-process, but that still maintains the necessary anatomical accuracy to provide informed preoperative planning decisions (Fig.&#x000a0;<xref rid="Fig25" ref-type="fig">25</xref>).<fig id="Fig25"><label>Fig. 25</label><caption><p>Sample output of the wrapping and smoothing operations on the model elements. Individual results may vary based on the selected parameters</p></caption><graphic xlink:href="41205_2017_22_Fig25_HTML" id="MO25"/></fig>
</p></sec><sec id="Sec14"><title>Preparing models for printing</title><p id="Par52">In order to ensure model printability on multi-material printers as demonstrated here, one needs to ensure that no model parts overlap and that all extraneous loose, non-contiguous model fragments are removed. This involves either using Boolean subtraction to subtract common portions of the various model parts, or alternatively, Boolean union to unify all constituent parts into a single whole to be 3D printed as a single unit. To illustrate the process of model cleanup for printing, consider the newly produced hollow trachea and the Lungs model which also contains the tracheal lumen and a portion of the contralateral lung. With this overlap of structures, the model may not be printed correctly (depending on the printer used), and inclusion of unneeded portions is wasteful (Fig.&#x000a0;<xref rid="Fig26" ref-type="fig">26</xref>).<fig id="Fig26"><label>Fig. 26</label><caption><p>Models of the trachea and the lung. Note the significant overlap</p></caption><graphic xlink:href="41205_2017_22_Fig26_HTML" id="MO26"/></fig>
</p><p id="Par53">To rectify this, first visualize the Trachea and the Lungs models by right clicking them and clicking &#x02018;Show&#x02019; from the Object Tree. Next, use the Design &#x0003e; Boolean Subtraction tool. This tool allows subtraction of one model from another. For the &#x02018;Entity&#x02019;, or the model to subtract from, choose the Lungs model, while the &#x02018;Subtraction Entity&#x02019; will be the Trachea_wrapped model, resulting in a model as shown (Fig.&#x000a0;<xref rid="Fig27" ref-type="fig">27</xref>).<fig id="Fig27"><label>Fig. 27</label><caption><p>Lung model following subtraction of the hollow trachea.</p></caption><graphic xlink:href="41205_2017_22_Fig27_HTML" id="MO27"/></fig>
</p><p id="Par54">Note that this model contains a number of disconnected fragments. Use the Mark &#x0003e; Shell tool to mark the left lung that we wish to keep. Use the Mark &#x0003e; Invert tool to select all the other parts, and press &#x02018;Delete&#x02019; on the keyboard to remove these (Fig.&#x000a0;<xref rid="Fig28" ref-type="fig">28</xref>). The same process can be repeated with all model parts to ensure no overlap.<fig id="Fig28"><label>Fig. 28</label><caption><p>Selecting the non-contiguous portions of the lung models and deleting them</p></caption><graphic xlink:href="41205_2017_22_Fig28_HTML" id="MO28"/></fig>
</p><p id="Par55">In a clinical production environment, individual models may be labeled using the Finish &#x0003e; Quick Label tool, and further inspected for quality issues using the Fix &#x0003e; Fix Wizard tool. The final STL models may also be simply copied by selecting them from the Object Tree using the CTRL&#x02009;+&#x02009;C shortcut and pasted into the inPrint or Mimics software with the original DICOM images using the CTRL&#x02009;+&#x02009;V shortcut for further inspection of their accuracy.</p></sec></sec><sec id="Sec15"><title>Computer-aided design</title><p id="Par56">While model post-processing is quite useful in optimizing models for printing, the role of Computer-aided design (CAD) is better exemplified by demonstrating an approach for the creation of a customized tracheal stent for a simulated case of significant tracheal stenosis secondary to mass effect from an adjacent mediastinal tumor (included in Additional files <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>).</p><sec id="Sec16"><title>Generating a customized tracheal stent</title><p id="Par57">We will start from a model of a patient&#x02019;s airway segmented from CT images to include air density HU range, followed by solid model creation. This model is available as additional data enclosed with this work. We shall begin by importing this solid airway model using methodology outlined in Section 2. The mass effect on the airway is from a simulated adjacent tumor, not shown (Fig.&#x000a0;<xref rid="Fig29" ref-type="fig">29</xref>).<fig id="Fig29"><label>Fig. 29</label><caption><p>Tracheal model with simulated mass effect</p></caption><graphic xlink:href="41205_2017_22_Fig29_HTML" id="MO29"/></fig>
</p><p id="Par58">We use a cylinder primitive to fill in the cavity left behind by the tumor. From the Design &#x0003e; Create Primitive menu, select the Create Cylinder option and set up the parameters as demonstrated, with a cylinder 35&#x000a0;mm long and 7.5&#x000a0;mm wide (Fig.&#x000a0;<xref rid="Fig30" ref-type="fig">30</xref>). These values were approximated by measuring the model directly using the tools in the Measure menu.<fig id="Fig30"><label>Fig. 30</label><caption><p>Create Cylinder operation. Note, you may need to find the origin within the Work Area to see the new cylinder</p></caption><graphic xlink:href="41205_2017_22_Fig30_HTML" id="MO30"/></fig>
</p><p id="Par59">This cylinder will be positioned into place using a combination of the Align &#x0003e; Interactive Translate and Align &#x0003e; Interactive Rotate functions, until the cylinder precisely reconstitutes the luminal defect (Fig.&#x000a0;<xref rid="Fig31" ref-type="fig">31</xref>).<fig id="Fig31"><label>Fig. 31</label><caption><p>Interactive rotation and translation, achieved by dragging corresponding arcs or axes in the model-associated orthogonal planes</p></caption><graphic xlink:href="41205_2017_22_Fig31_HTML" id="MO31"/></fig>
</p><p id="Par60">The resultant model, consisting of a cylinder and the original airway can then be fused into a single entity, renamed &#x02018;Stent Prototype&#x02019;, using the Boolean Union function to generate a model of an intact airway (Fig.&#x000a0;<xref rid="Fig32" ref-type="fig">32</xref>).<fig id="Fig32"><label>Fig. 32</label><caption><p>Boolean Union operation to create the first approximation of the stent prototype</p></caption><graphic xlink:href="41205_2017_22_Fig32_HTML" id="MO32"/></fig>
</p><p id="Par61">To ensure the intended stent can be placed within the trachea, it needs to conform to the inner lumen of the trachea, but not exceed it. Thus, a degree of scaling or offset is required. While this is possible with a dedicated Scaling function in 3-matic, this can be achieved during object wrapping with an offset parameter specified as -1&#x000a0;mm (Fig.&#x000a0;<xref rid="Fig33" ref-type="fig">33</xref>). This effectively ensures a 1&#x000a0;mm inner offset for the newly created, wrapped part and acts as an equivalent of scaling the model to a size that is amenable for placement within the airway. Smooth this part as previously indicated.<fig id="Fig33"><label>Fig. 33</label><caption><p>Setup and the result of the Wrap operation (blue) with a -1&#x000a0;mm offset in relation to the original Boolean Union result (grey, transparent)</p></caption><graphic xlink:href="41205_2017_22_Fig33_HTML" id="MO33"/></fig>
</p><p id="Par62">The resultant scaled, solid model with smoothed transition between the cylinder and patient&#x02019;s trachea, is ready to simulate a stent. Since the stent is a hollow structure, we will use the methodology of Section 2.1 to create this hollow structure, this time opting to create 1&#x000a0;mm walls on the inside of this model (Fig.&#x000a0;<xref rid="Fig34" ref-type="fig">34</xref>).<fig id="Fig34"><label>Fig. 34</label><caption><p>Setup and result of the Hollow operation</p></caption><graphic xlink:href="41205_2017_22_Fig34_HTML" id="MO34"/></fig>
</p><p id="Par63">Trim the stent to desired size using the Finish &#x0003e; Trim function as indicated, opting to remove all parts outside of the shape demonstrated (Fig.&#x000a0;<xref rid="Fig35" ref-type="fig">35</xref>), making a ready-to-print model (Fig.&#x000a0;<xref rid="Fig36" ref-type="fig">36</xref>).<fig id="Fig35"><label>Fig. 35</label><caption><p>Setting up the trimming operation to create a hollow stent</p></caption><graphic xlink:href="41205_2017_22_Fig35_HTML" id="MO35"/></fig>
<fig id="Fig36"><label>Fig. 36</label><caption><p>Final stent (blue) inside the original airway model (red), demonstrating adherence to the lumen</p></caption><graphic xlink:href="41205_2017_22_Fig36_HTML" id="MO36"/></fig>
</p><p id="Par64">Please note that while the approaches demonstrated here are highly simplified and would not be used without further refinements, they illustrate principles of CAD. Alternative approaches to achieve similar results exist, and may, for example, involve drawing the desired configuration of the trachea and main stem bronchi directly on the DICOM images during the segmentation step using the Brush tool in inPrint, as discussed earlier, or using midline symmetry to replicate the native configuration of the trachea as discussed in the 2016 course [<xref ref-type="bibr" rid="CR2">2</xref>].</p></sec><sec id="Sec17"><title>Advanced CAD: Injection molding design</title><p id="Par65">Combinations of the tools discussed above can be applied to create complex patient-specific guides using primitive geometrical shapes as well as 3D models obtained by scanning medical devices and surgical guides, or importing their premade CAD models. With the ability to deform and align such objects as necessary, the range of possible applications of the CAD tools discussed is quite wide.</p><p id="Par66">As an example, consider the creation of injection molding for the patient-specific stent designed above. Molding is highly beneficial where rapid and inexpensive model replication is desired, for example in educational settings where a large number of models are used such that model destruction is expected as part of the process. Parts and devices that are expected to undergo a high replacement rate can also be replicated using molding. Note that although the precise design considerations for mold optimization are numerous, the intent of this work is to expose the reader to a basic approach that can be subsequently optimized in practical applications.</p><p id="Par67">Although there are a wide number of approaches to 3D printed model replication using resin molds, including direct creation of molds starting from the desired 3D printed model, we will demonstrate the de novo creation of a mold using CAD tools. This process will consist of the design of an outer shell and the appropriately positioned inner shell, such that the molded part is retrievable and functional without the destruction of the mold, which can then be reused for multiple additional parts with a variety of resins of different colors and material properties.</p><p id="Par68">To begin, create a box primitive with parameters as demonstrated (Design &#x0003e; Create Primitive &#x0003e; Create Box), ensuring complete encapsulation of the target part with the primitive geometry (Fig.&#x000a0;<xref rid="Fig37" ref-type="fig">37</xref>).<fig id="Fig37"><label>Fig. 37</label><caption><p>Setup for the Create Box operation</p></caption><graphic xlink:href="41205_2017_22_Fig37_HTML" id="MO37"/></fig>
</p><p id="Par69">This primitive is then moved to overlap the stent model using the free translate tool discussed earlier, and the stent model is subtracted from the primitive using Boolean Subtraction, resulting in a hollow structure amenable for trimming along the outer edges of the stent (Fig.&#x000a0;<xref rid="Fig38" ref-type="fig">38</xref>).<fig id="Fig38"><label>Fig. 38</label><caption><p>Using the trimming function on the result of subtraction of the stent from the box primitive</p></caption><graphic xlink:href="41205_2017_22_Fig38_HTML" id="MO38"/></fig>
</p><p id="Par70">The resultant trimmed Boolean Subtraction product consists of two shells &#x02013; the inner shell that outlines the internal portion of the mold and the outer shell that outlines the external portion. By duplicating the resultant structure (Right-Click in the Object Tree and select Duplicate), the outer and inner portions of this model can be preserved in separate models by using the Mark &#x0003e; Shell tool to mark and delete (Delete key on keyboard) the inner and outer portions of the model respectively. Furthermore, to create an openable external portion, it may be cut in two pieces using the Trim function with the &#x02018;Preserve inner and outer&#x02019; option, resulting in a three-part model (Fig.&#x000a0;<xref rid="Fig39" ref-type="fig">39</xref>).<fig id="Fig39"><label>Fig. 39</label><caption><p>The result of separation of inner and outer portions and trimming the outer portion</p></caption><graphic xlink:href="41205_2017_22_Fig39_HTML" id="MO39"/></fig>
</p><p id="Par71">To hold the inner part in place and ensure 1&#x000a0;mm wall thickness of the stent, support cylinders may be created using the Create Cylinder function and aligned such that the internal molding part is entirely traversed in an orthogonal axis extent (Z axis in this case), and the cylinders are within the bounds of the external portion of the mold (Fig.&#x000a0;<xref rid="Fig40" ref-type="fig">40</xref>).<fig id="Fig40"><label>Fig. 40</label><caption><p>Setup for the Create Cylinder operation</p></caption><graphic xlink:href="41205_2017_22_Fig40_HTML" id="MO40"/></fig>
</p><p id="Par72">In this demonstration, four cylinders were created and aligned. These cylinders are then trimmed along the midline of the internal part, keeping the inner and outer products of the trim function in place. Using Boolean Union, the appropriate supports are then united with their respective portions of the outer shell of the mold (Fig.&#x000a0;<xref rid="Fig41" ref-type="fig">41</xref>).<fig id="Fig41"><label>Fig. 41</label><caption><p>Trimming the support pins (left), using the Boolean union operation on the pins and the appropriate outer mold part (center), with the final result demonstrated (right)</p></caption><graphic xlink:href="41205_2017_22_Fig41_HTML" id="MO41"/></fig>
</p><p id="Par73">Boolean subtraction of the inner part of the mold from the upper and lower external parts of the mold will ensure precise positioning of the inner part on the support pins, thus yielding a usable, aligned final cast. As a tradeoff for this alignment, several surface defects will be present on the stent, but are most likely to be of limited clinical significance (Fig.&#x000a0;<xref rid="Fig42" ref-type="fig">42</xref>).<fig id="Fig42"><label>Fig. 42</label><caption><p>Final mold assembled (left) and with the upper part demonstrated separately. Note the support pins, which can be of variable diameter</p></caption><graphic xlink:href="41205_2017_22_Fig42_HTML" id="MO42"/></fig>
</p></sec></sec><sec id="Sec18"><title>Practical considerations of 3D printing software</title><p id="Par74">In principle, the process of submitting a model to a 3D printer is highly variable, and ranges from placement of a model onto an external storage device which is then inserted into the printer to using a graphical user interface to submit a model to a printer connected to the computer directly or through a network. The end result, however, is the translation of the 3D geometry stored within STL or similar files into a set of printer instructions, such as movement paths for the printer head, print bed movement, and a range of instructions that are highly dependent on the printer used.</p><p id="Par75">To demonstrate the practical aspects of 3D printing, this paper uses Stratasys GrabCAD, a standalone software and online printing service capable of handling a wide range of printers (Fig.&#x000a0;<xref rid="Fig43" ref-type="fig">43</xref>).<fig id="Fig43"><label>Fig. 43</label><caption><p>GrabCAD graphical user interface, with visualization of the printable&#x000a0;3D model on a dynamically rotatable tray that adheres to the dimensions of the selected printer. Associated print settings allow the selection of materials for individual models, as well as model placement and cost estimation</p></caption><graphic xlink:href="41205_2017_22_Fig43_HTML" id="MO43"/></fig>
</p><p id="Par76">The interface is intuitive and can be used to discuss submitting 3D models for printing in general. One typically imports the model as a standalone item or an assembly using any of a number of acceptable formats, including STL. In the case of the Pancoast tumor model generated here, one would import all parts as an assembly to ensure correct alignment in the complex multi-material model.</p><p id="Par77">Automated or manual on-tray arrangement tools are then applied to minimize support material use, and upon satisfactory alignment, the material and time costs are estimated (Fig.&#x000a0;<xref rid="Fig44" ref-type="fig">44</xref>). This is not always ideal following automated placement and manual adjustments are frequently required. Following satisfaction with this estimate, the print is initiated. Although this process often requires optimization for appropriate results, the overall experience across platforms has matured in the recent years tremendously and has been optimized to result in tremendously valuable medical models (Fig.&#x000a0;<xref rid="Fig45" ref-type="fig">45</xref>).<fig id="Fig44"><label>Fig. 44</label><caption><p>Results of dynamic cost estimates within the GrabCAD software. Typically, several printing options are provided -here, High Quality has a 14&#x000a0;&#x003bc;m resolution while High Mix results in 27&#x000a0;&#x003bc;m resolution prints</p></caption><graphic xlink:href="41205_2017_22_Fig44_HTML" id="MO44"/></fig>
<fig id="Fig45"><label>Fig. 45</label><caption><p>Left, a model of the entire bony and vascular thorax from the case presented here. Right, the left upper thorax segmented and further processed in this work. The tumor is shown in green, and closely abuts but does not involve the adjacent arterial vasculature</p></caption><graphic xlink:href="41205_2017_22_Fig45_HTML" id="MO45"/></fig>
</p></sec><sec id="Sec19"><title>Conclusion</title><p id="Par78">As applications of 3D printing in medicine continue to expand, familiarity with the basic software operations and tasks becomes increasingly important. This technical note presented at the 2017 annual meeting of the RSNA expands on our earlier teaching sessions to include segmentation and printing of a Pancoast tumor. Finally, the application of patient-specific airway stent design with CAD demonstrates some of the basic techniques involved in clinical applications of 3D printing.</p></sec><sec sec-type="supplementary-material"><title>Additional file</title><sec id="Sec20"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41205_2017_22_MOESM1_ESM.mcs"><label>Additional file 1:</label><caption><p>Segmentation. (MCS 92160 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41205_2017_22_MOESM2_ESM.mxp"><label>Additional file 2:</label><caption><p>Pancoast CAD. (MXP 14411 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41205_2017_22_MOESM3_ESM.mxp"><label>Additional file 3:</label><caption><p>Stent design. (MXP 2364 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>3D</term><def><p id="Par2">Three dimensional</p></def></def-item><def-item><term>CAD</term><def><p id="Par3">Computer-aided design</p></def></def-item><def-item><term>CT</term><def><p id="Par4">Computed tomography</p></def></def-item><def-item><term>DICOM</term><def><p id="Par5">Digital imaging and communications in medicine</p></def></def-item><def-item><term>FDA</term><def><p id="Par6">United States Food and Drug Administration</p></def></def-item><def-item><term>HU</term><def><p id="Par7">Hounsfield units</p></def></def-item><def-item><term>MRI</term><def><p id="Par8">Magnetic resonance imaging</p></def></def-item><def-item><term>ROI</term><def><p id="Par9">Region of interest</p></def></def-item><def-item><term>RSNA</term><def><p id="Par10">Radiological Society of North America</p></def></def-item><def-item><term>STL</term><def><p id="Par11">Standard tessellation language/Stereolithography</p></def></def-item></def-list></glossary><ack><sec id="FPar1"><title>Availability of data and materials</title><p id="Par79">All data used within this Technical Note is included as Additional files <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>. Free trial versions of the Materialise software are available from Materialise website.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>LC and AS designed the course and wrote the manuscript. All authors contributed to the manuscript and tested manuscript contents. All authors have reviewed and corrected the final manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>This work has received no targeted funding.</p></notes><notes notes-type="COI-statement"><sec id="FPar2"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="FPar3"><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giannopoulos</surname><given-names>AA</given-names></name><name><surname>Chepelev</surname><given-names>LL</given-names></name><name><surname>Sheikh</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Dang</surname><given-names>W</given-names></name><name><surname>Akyuz</surname><given-names>E</given-names></name><name><surname>Hong</surname><given-names>C</given-names></name><name><surname>Wake</surname><given-names>N</given-names></name><name><surname>Pietila</surname><given-names>P</given-names></name><name><surname>Dydynski</surname><given-names>PB</given-names></name><name><surname>Mitsouras</surname><given-names>D</given-names></name><name><surname>Rybicki</surname><given-names>FJ</given-names></name></person-group><article-title>3D printed ventricular Septal defect patch: a primer for the 2015 Radiological Society of North America (RSNA) hands-on course in 3D printing</article-title><source>3D Printing in Medicine</source><year>2015</year><volume>1</volume><fpage>3</fpage><pub-id pub-id-type="doi">10.1186/s41205-015-0002-4</pub-id><pub-id pub-id-type="pmid">30050972</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chepelev</surname><given-names>LL</given-names></name><name><surname>Hodgdon</surname><given-names>T</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Torres</surname><given-names>C</given-names></name><name><surname>Krishna</surname><given-names>S</given-names></name><name><surname>Akyuz</surname><given-names>E</given-names></name><name><surname>Mitsouras</surname><given-names>D</given-names></name></person-group><article-title>Medical 3D printing for vascular interventions and surgical oncology: a primer for the 2016 Radiological Society of North America (RSNA) hands-on course in 3D printing</article-title><source>3D Printing in Medicine</source><year>2016</year><volume>2</volume><fpage>5</fpage><pub-id pub-id-type="doi">10.1186/s41205-016-0008-6</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitsouras</surname><given-names>D</given-names></name><name><surname>Liacouras</surname><given-names>P</given-names></name><name><surname>Imanzadeh</surname><given-names>A</given-names></name><name><surname>Giannopoulos</surname><given-names>AA</given-names></name><name><surname>Cai</surname><given-names>T</given-names></name><name><surname>Kumamaru</surname><given-names>KK</given-names></name><name><surname>George</surname><given-names>E</given-names></name><name><surname>Wake</surname><given-names>N</given-names></name><name><surname>Caterson</surname><given-names>EJ</given-names></name><name><surname>Pomahac</surname><given-names>B</given-names></name><name><surname>Ho</surname><given-names>VB</given-names></name><name><surname>Grant</surname><given-names>GT</given-names></name><name><surname>Rybicki</surname><given-names>FJ</given-names></name></person-group><article-title>Medical 3D printing for the radiologist</article-title><source>Radiographics</source><year>2015</year><volume>35</volume><fpage>1965</fpage><lpage>1988</lpage><pub-id pub-id-type="doi">10.1148/rg.2015140320</pub-id><pub-id pub-id-type="pmid">26562233</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chepelev</surname><given-names>L</given-names></name><name><surname>Giannopoulos</surname><given-names>A</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name><name><surname>Mitsouras</surname><given-names>D</given-names></name><name><surname>Rybicki</surname><given-names>FJ</given-names></name></person-group><article-title>Medical 3D printing: methods to standardize terminology and report trends</article-title><source>3D Printing in Medicine</source><year>2017</year><volume>3</volume><fpage>4</fpage><pub-id pub-id-type="doi">10.1186/s41205-017-0012-5</pub-id><pub-id pub-id-type="pmid">30050981</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>George</surname><given-names>E</given-names></name><name><surname>Barile</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name><name><surname>Wiesel</surname><given-names>O</given-names></name><name><surname>Coppolino</surname><given-names>A</given-names></name><name><surname>Giannopoulos</surname><given-names>A</given-names></name><name><surname>Mentzer</surname><given-names>S</given-names></name><name><surname>Jaklitsch</surname><given-names>M</given-names></name><name><surname>Hunsaker</surname><given-names>A</given-names></name><name><surname>Mitsouras</surname><given-names>D</given-names></name></person-group><article-title>Utility and reproducibility of 3-dimensional printed models in pre-operative planning of complex thoracic tumors</article-title><source>J Surg Oncol</source><year>2017</year><volume>116</volume><fpage>407</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1002/jso.24684</pub-id><pub-id pub-id-type="pmid">28753252</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillaspie</surname><given-names>EA</given-names></name><name><surname>Matsumoto</surname><given-names>JS</given-names></name><name><surname>Morris</surname><given-names>NE</given-names></name><name><surname>Downey</surname><given-names>RJ</given-names></name><name><surname>Shen</surname><given-names>KR</given-names></name><name><surname>Allen</surname><given-names>MS</given-names></name><name><surname>Blackmon</surname><given-names>SH</given-names></name></person-group><article-title>From 3-dimensional printing to 5-dimensional printing: enhancing thoracic surgical planning and resection of complex tumors</article-title><source>Ann Thorac Surg</source><year>2016</year><volume>101</volume><fpage>1958</fpage><lpage>1962</lpage><pub-id pub-id-type="doi">10.1016/j.athoracsur.2015.12.075</pub-id><pub-id pub-id-type="pmid">27106426</pub-id></element-citation></ref></ref-list></back></article>